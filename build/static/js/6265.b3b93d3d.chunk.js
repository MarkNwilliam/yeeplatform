"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[6265],{46265:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var a=o(72791),l=o(21830),n=o.n(l),r=o(61567),s=o(55294),i=o(20890),c=o(40412),d=o(15770),u=o(17638),h=o(90602),m=o(48969),g=o(86251),x=o(29675),b=o(80184);const f=500;const p=function(){const[e,t]=(0,a.useState)(null),[o,l]=(0,a.useState)(null),[p,v]=(0,a.useState)(""),[w,j]=(0,a.useState)(""),[y,N]=(0,a.useState)([]),[C,Z]=(0,a.useState)(""),[E,S]=(0,a.useState)(""),[k,U]=(0,a.useState)(""),[F,L]=(0,a.useState)(!1),[P,B]=(0,a.useState)(""),[T,z]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),[I,O]=(0,a.useState)("free"),[A,q]=(0,a.useState)(""),[H,M]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(!1),_=r.I8.currentUser.uid;return(0,a.useEffect)((()=>{const e=()=>{W&&Y(!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[W]),(0,b.jsxs)("div",{className:"p-8 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,b.jsx)(i.Z,{variant:"h4",className:"text-center mb-6",children:"Upload your Audiobook"}),(0,b.jsxs)("form",{onSubmit:async a=>{a.preventDefault();const r="notfree"===I;if(w.length>f)return void n().fire("Error","Description should not exceed ".concat(f," characters."),"error");if(e&&e.size>314572800)return void n().fire("Error","Audiobook file size should not exceed ".concat(300," MB."),"error");if(p.length<3||p.length>100)return void n().fire("Error","Title should be between ".concat(3," and ").concat(100," characters."),"error");if(!C)return void n().fire("Error","Please select a language.","error");const i=new Date;if(new Date(k)>i)return void n().fire("Error","Publication date cannot be in the future.","error");if(y.length<1)return void n().fire("Error","Please select at least ".concat(1," genre(s)."),"error");n().fire({title:"Uploading...",html:"Progress ....",allowEscapeKey:!1,allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!1,onBeforeOpen:()=>{n().showLoading()},onOpen:()=>{const e=n().getHtmlContainer(),t=document.createElement("div");t.setAttribute("class","sweetalert2-progress-steps"),e.appendChild(t)}});try{let a,i,c;if(o){const e=await(0,x.tg)(o,128);c=await(0,g.Z)(e,!0),console.log("Here is my thumbnail url "+c)}if(e&&(a=await(0,g.Z)(e)),o&&(console.log("Uploading coverFile: ",o),i=await(0,g.Z)(o),console.log("This is my coverurl "+i)),w.length>f)return void n().fire("Error","Description should not exceed ".concat(f," characters."),"error");if(!a||!i)throw new Error("Please select both audio and cover files.");const d={title:p,description:w,genres:y.join(", "),categories:y.join(", "),language:C,isbn:E,ebookUrl:a,coverUrl:i,thumbnailUrl:c,publicationDate:k,author_platform_id:_,Duration:D,monetization:r,audioUrl:a},u=await s.Z.post("http://localhost:3000/audiobookupload/".concat(_),d);if(n().close(),200!==u.status)throw new Error("Error while sending data to the server.");t(null),l(null),v(""),j(""),N([]),Z(""),S(""),R(""),U(""),B(""),z(""),O("free"),q(""),Y(!0)}catch(c){n().fire("Error","Error uploading the audio. Please try again.","error"),console.error("Error uploading the audio:",c)}},encType:"multipart/form-data",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Title:"}),(0,b.jsx)(c.Z,{fullWidth:!0,variant:"outlined",value:p,onChange:e=>v(e.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Description:"}),(0,b.jsx)(c.Z,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:w,onChange:e=>j(e.target.value),required:!0,helperText:"".concat(w.length,"/").concat(f)})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)(m.Z,{label:"Upload Cover Image:",onChange:async e=>{const t=e.target.files[0];if(console.log("Handle Cover Change Function Called"),t){if(!(e=>e.size/1024/1024<=5)(t)){try{n().fire({icon:"error",title:"Error",text:"Image size should not exceed 5MB."}).then((()=>{l(null),B(""),q("")}))}catch(o){console.log(o)}return}const e=await(e=>new Promise((t=>{const o=new Image;o.onload=()=>{t(512===o.width&&800===o.height)},o.src=URL.createObjectURL(e)})))(t);if(!e){try{n().fire({icon:"error",title:"Error",text:"Image dimensions should be exactly 512x800 pixels.",timer:3e3}).then((()=>{l(null),B(""),q("")}))}catch(o){console.log(o)}return}l(t),B(t.name),q(URL.createObjectURL(t)),console.log("Function Execution Completed")}},fileName:P,accept:".jpg, .jpeg, .png",required:!0}),A&&(0,b.jsx)("div",{className:"image-preview",children:(0,b.jsx)("img",{src:A,alt:"Cover Preview",style:{maxWidth:"200px",maxHeight:"200px"}})})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(d.Z,{multiple:!0,options:["Fiction","Nonfiction","Science Fiction","Romance","Mystery/Thriller","Fantasy","Biography","History","Business/Economics","Self-help","Health/Fitness","Cooking/Food","Travel","Technology"],value:y,onChange:(e,t)=>N(t),renderInput:e=>(0,b.jsx)(c.Z,{...e,variant:"outlined",label:"Genres"})})}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(d.Z,{options:[{code:"eng",label:"English"},{code:"French",label:"French"},{code:"swahili",label:"Swahili"},{code:"amharic",label:"Amharic"},{code:"yoruba",label:"Yoruba"},{code:"oromo",label:"Oromo"},{code:"igbo",label:"Igbo"},{code:"zulu",label:"Zulu"},{code:"shona",label:"Shona"},{code:"xhosa",label:"Xhosa"},{code:"hausa",label:"Hausa"},{code:"fulani",label:"Fulani"}].map((e=>e.label)),value:C,onChange:(e,t)=>Z(t),renderInput:e=>(0,b.jsx)(c.Z,{...e,variant:"outlined",label:"Language"})})}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"ISBN:"}),(0,b.jsx)(c.Z,{fullWidth:!0,variant:"outlined",value:E,onChange:e=>S(e.target.value)})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Monetization:"}),(0,b.jsxs)("select",{value:I,onChange:e=>O(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[(0,b.jsx)("option",{value:"free",children:"Free"}),(0,b.jsx)("option",{value:"notfree",children:"Not Free"})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Publication Date:"}),(0,b.jsx)(c.Z,{type:"date",fullWidth:!0,variant:"outlined",value:k,onChange:e=>U(e.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)(m.Z,{label:"Upload Audio File:",onChange:e=>{var o;t(e.target.files[0]),z((null===(o=e.target.files[0])||void 0===o?void 0:o.name)||""),(e=>{const t=URL.createObjectURL(e);let o=new Audio(t);o.onloadedmetadata=()=>{R(Math.floor(o.duration)),URL.revokeObjectURL(t)}})(e.target.files[0])},fileName:T,accept:".mp3, .wav",required:!0}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:["Maximum file size: ",300," MB"]})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(h.Z,{buttonText:"Upload"})})]}),W&&(0,b.jsx)(u.Z,{isOpen:W,onClose:()=>{console.log("Closing success dialog"),Y(!1)},points:100,message:"Well done! You're a real YeePlatform author."})]})}},86251:(e,t,o)=>{o.d(t,{Z:()=>a});const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=await fetch("http://localhost:3000/generateSasToken"),a=(await o.json()).sasToken;let l=t?"thumbnail-".concat(Date.now(),".jpg"):e.name;const n="https://yeeplatform.blob.core.windows.net/yeeusers/".concat(l,"?").concat(a),r={method:"PUT",body:e,headers:{"x-ms-blob-type":"BlockBlob"}};if((await fetch(n,r)).ok){return n.split("?")[0]}throw new Error("Error uploading to Azure Blob Storage")}},29675:(e,t,o)=>{o.d(t,{Rn:()=>r,tg:()=>n});var a=o(98968);const l=o.n(a)()(),n=(e,t)=>new Promise(((o,a)=>{const n=new FileReader;n.onload=e=>{const n=new Image;n.onload=()=>{const e=t/n.width,r=n.height*e,s=document.createElement("canvas");s.width=t,s.height=r,l.resize(n,s).then((e=>l.toBlob(e,"image/jpeg",.8))).then((e=>o(e))).catch((e=>a(e)))},n.src=e.target.result},n.onerror=a,n.readAsDataURL(e)})),r=(e,t,o)=>{const a=e.size/1048576;return a>=t&&a<=o}},90602:(e,t,o)=>{o.d(t,{Z:()=>l});o(72791);var a=o(80184);const l=function(e){let{buttonText:t}=e;return(0,a.jsx)("button",{type:"submit",className:"bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:shadow-outline",children:t})}},17638:(e,t,o)=>{o.d(t,{Z:()=>u});var a=o(72791),l=o(5289),n=o(97123),r=o(39157),s=o(10387),i=o(94294),c=o(58510),d=o(80184);const u=function(e){let{isOpen:t,onClose:u,points:h,message:m}=e;const g=a.lazy((()=>Promise.resolve().then(o.t.bind(o,59741,23))));return(0,d.jsxs)(l.Z,{open:t,onClose:u,children:[(0,d.jsx)(s.Z,{className:"text-center",children:"Success!"}),(0,d.jsxs)(r.Z,{className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)(a.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading..."}),children:(0,d.jsx)(g,{animationData:c,style:{width:"auto",maxWidth:"100%",height:200}})}),(0,d.jsx)("p",{children:m}),(0,d.jsxs)("div",{className:"text-center animate-pulse",children:[(0,d.jsx)("p",{className:"text-yellow-500 font-bold text-xl",children:"You've got"}),(0,d.jsxs)("span",{className:"text-4xl text-yellow-500",children:[h," Points!"]})]}),(0,d.jsx)("p",{children:"Your content will be available in the marketplace soon."})]}),(0,d.jsx)(n.Z,{children:(0,d.jsx)(i.Z,{onClick:u,color:"primary",children:"Close"})})]})}},48969:(e,t,o)=>{o.d(t,{Z:()=>n});o(72791);var a=o(69596),l=o(80184);const n=function(e){let{label:t,onChange:o,fileName:n,accept:r,required:s}=e;return(0,l.jsxs)("div",{children:[t&&(0,l.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:t}),(0,l.jsxs)("label",{className:"w-full flex items-center px-4 py-2 rounded-lg shadow-lg tracking-wide uppercase border cursor-pointer hover:bg-yellow-500 hover:text-white ".concat(n?"bg-yellow-500 text-white":"bg-white text-yellow-500 border-yellow-500"),children:[(0,l.jsx)(a.Z,{className:"mr-2"}),n||"Choose File",(0,l.jsx)("input",{type:"file",onChange:o,className:"hidden",accept:r,required:s})]})]})}}}]);
//# sourceMappingURL=6265.b3b93d3d.chunk.js.map