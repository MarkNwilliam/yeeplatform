"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[9466],{69466:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var a=r(65043),s=r(30064),o=r.n(s),n=r(67591),l=r(85865),i=r(17731),c=r(88861),d=r(55440),h=r(63713),u=r(10142),m=r(54978),p=r(86032),x=r(70579);const g=()=>{var e;const[t,r]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=()=>{t&&r(!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[t]);const[s,g]=(0,a.useState)(""),[b,f]=(0,a.useState)(""),[w,j]=(0,a.useState)(""),[v,y]=(0,a.useState)(null),[N,C]=(0,a.useState)(""),[S,k]=(0,a.useState)(!1),[A,E]=(0,a.useState)([]),[F,z]=(0,a.useState)(""),[U,B]=(0,a.useState)(null),T=e=>new Promise((t=>{const r=new Image;r.onload=()=>{t(512===r.width&&800===r.height)},r.src=URL.createObjectURL(e)})),L=null===(e=(0,n.xI)().currentUser)||void 0===e?void 0:e.uid;return(0,x.jsxs)("div",{className:"p-8 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,x.jsx)(l.A,{variant:"h4",className:"text-center mb-6",children:"Upload a Chapter"}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s.length<5||b.length<20||w.length<100)return void o().fire("Error!","Please ensure all fields meet the minimum length requirements.","error");o().fire({title:"Uploading...",text:"Please wait...",allowEscapeKey:!1,allowOutsideClick:!1,showConfirmButton:!1,onBeforeOpen:()=>{o().showLoading()}});let t="";if(U)try{const e=await(0,m.yh)(v,256);t=await(0,p.A)(e,!0)}catch(n){return console.error("Error resizing image:",n),void o().fire("Error","Failed to resize the image.","error")}const a=new FormData;a.append("title",s),a.append("description",b),a.append("content",w),a.append("type","Text"),a.append("author_platform_id",L),a.append("categories",A.join(", ")),a.append("thumbnailUrl",t),v&&a.append("coverimage",v);try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/uploadchapter/".concat(L),{method:"POST",body:a}),t=await e.text();if(console.log("Response Status:",e.status),console.log("Response Body:",t),o().close(),!e.ok)throw new Error("Error uploading chapter");JSON.parse(t);r(!0),g(""),f(""),j(""),y(null),C(""),z(""),E([])}catch(n){o().close(),o().fire("Error!",n.message,"error")}},children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{htmlFor:"title",className:"block text-gray-700 text-sm font-bold mb-2",children:"Title"}),(0,x.jsx)("input",{type:"text",id:"title",className:"w-full p-2 border rounded",value:s,onChange:e=>g(e.target.value),required:!0}),(0,x.jsxs)("p",{className:"text-right text-xs",children:[s.length,"/",100]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description"}),(0,x.jsx)("textarea",{id:"description",className:"w-full p-2 border rounded",value:b,onChange:e=>f(e.target.value),required:!0}),(0,x.jsxs)("p",{className:"text-right text-xs",children:[b.length,"/",500]})]}),(0,x.jsx)("div",{className:"mb-4",children:(0,x.jsx)(i.A,{multiple:!0,options:["Fiction","Nonfiction","Science Fiction","Romance","Mystery/Thriller","Fantasy","Biography","History","Business/Economics","Self-help","Health/Fitness","Cooking/Food","Travel","Technology"],getOptionLabel:e=>e,filterSelectedOptions:!0,value:A,onChange:(e,t)=>E(t),renderInput:e=>(0,x.jsx)(c.A,{...e,variant:"outlined",label:"Categories",placeholder:"Select Categories"})})}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{htmlFor:"content",className:"block text-gray-700 text-sm font-bold mb-2",children:"Content"}),(0,x.jsx)("textarea",{id:"content",rows:"10",className:"w-full p-2 border rounded",value:w,onChange:e=>j(e.target.value),required:!0}),(0,x.jsxs)("p",{className:"text-right text-xs",children:[w.length,"/",1e4]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)(d.A,{onChange:async e=>{const t=e.target.files[0];if(t){if(!(0,m.S1)(t,.001,5))return void o().fire("Error","Image size should not exceed 5MB.","error");if(!await T(t,512,800))return void o().fire("Error","Invalid image dimensions.","error");try{y(t),C(t.name),z(URL.createObjectURL(t))}catch(r){console.error("Error resizing image:",r),o().fire("Error","Failed to resize the image.","error")}}},fileName:N,accept:".jpg, .jpeg, .png",label:"Upload Cover Image (Max size: ".concat(5,"MB)")}),F&&(0,x.jsx)("img",{src:F,alt:"Cover Preview",className:"mt-4 w-full h-auto"})]}),(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)(h.A,{buttonText:"Upload"})})]}),t&&(0,x.jsx)(u.A,{isOpen:t,onClose:()=>r(!1),points:5,message:"Well done! You're a real YeePlatform author."})]})}},86032:(e,t,r)=>{r.d(t,{A:()=>a});const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await fetch("https://yeeplatformbackend.azurewebsites.net/generateSasToken"),a=(await r.json()).sasToken;let s=t?"thumbnail-".concat(Date.now(),".jpg"):e.name;const o="https://yeeplatform.blob.core.windows.net/yeeebooks/".concat(s,"?").concat(a),n={method:"PUT",body:e,headers:{"x-ms-blob-type":"BlockBlob"}};if((await fetch(o,n)).ok){return o.split("?")[0]}throw new Error("Error uploading to Azure Blob Storage")}},54978:(e,t,r)=>{r.d(t,{S1:()=>n,yh:()=>o});var a=r(55861);const s=r.n(a)()(),o=(e,t)=>new Promise(((r,a)=>{const o=new FileReader;o.onload=e=>{const o=new Image;o.onload=()=>{const e=t/o.width,n=o.height*e,l=document.createElement("canvas");l.width=t,l.height=n,s.resize(o,l).then((e=>s.toBlob(e,"image/jpeg",.8))).then((e=>r(e))).catch((e=>a(e)))},o.src=e.target.result},o.onerror=a,o.readAsDataURL(e)})),n=(e,t,r)=>{const a=e.size/1048576;return a>=t&&a<=r}},63713:(e,t,r)=>{r.d(t,{A:()=>s});r(65043);var a=r(70579);const s=function(e){let{buttonText:t}=e;return(0,a.jsx)("button",{type:"submit",className:"bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:shadow-outline",children:t})}},10142:(e,t,r)=>{r.d(t,{A:()=>h});var a=r(65043),s=r(90035),o=r(29347),n=r(35316),l=r(26600),i=r(11906),c=r(12707),d=r(70579);const h=function(e){let{isOpen:t,onClose:h,points:u,message:m}=e;const p=a.lazy((()=>Promise.resolve().then(r.t.bind(r,93750,23))));return(0,d.jsxs)(s.A,{open:t,onClose:h,children:[(0,d.jsx)(l.A,{className:"text-center",children:"Success!"}),(0,d.jsxs)(n.A,{className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)(a.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading..."}),children:(0,d.jsx)(p,{animationData:c,style:{width:"auto",maxWidth:"100%",height:200}})}),(0,d.jsx)("p",{children:m}),(0,d.jsxs)("div",{className:"text-center animate-pulse",children:[(0,d.jsx)("p",{className:"text-yellow-500 font-bold text-xl",children:"You've got"}),(0,d.jsxs)("span",{className:"text-4xl text-yellow-500",children:[u," Points!"]})]}),(0,d.jsx)("p",{children:"Your content will be available in the marketplace soon."})]}),(0,d.jsx)(o.A,{children:(0,d.jsx)(i.A,{onClick:h,color:"primary",children:"Close"})})]})}},55440:(e,t,r)=>{r.d(t,{A:()=>o});r(65043);var a=r(62954),s=r(70579);const o=function(e){let{label:t,onChange:r,fileName:o,accept:n,required:l}=e;return(0,s.jsxs)("div",{children:[t&&(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:t}),(0,s.jsxs)("label",{className:"w-full flex items-center px-4 py-2 rounded-lg shadow-lg tracking-wide uppercase border cursor-pointer hover:bg-yellow-500 hover:text-white ".concat(o?"bg-yellow-500 text-white":"bg-white text-yellow-500 border-yellow-500"),children:[(0,s.jsx)(a.A,{className:"mr-2"}),o||"Choose File",(0,s.jsx)("input",{type:"file",onChange:r,className:"hidden",accept:n,required:l})]})]})}}}]);
//# sourceMappingURL=9466.a0120245.chunk.js.map