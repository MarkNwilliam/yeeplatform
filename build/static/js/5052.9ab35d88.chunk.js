"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[5052],{46681:(e,t,o)=>{o.d(t,{A:()=>i});var a=o(65043),n=o(71935),r=(o(88331),o(70579));const i=e=>{let{handleNewUserMessage:t}=e;const[o,i]=(0,a.useState)(!0);return(0,r.jsx)(n.Widget,{handleNewUserMessage:t,title:"Ebook Chatbot",subtitle:"Ask me anything about this ebook",profileAvatar:"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp",emojis:"true",handleToggle:e=>{i((e=>!e))}})}},84847:(e,t,o)=>{o.r(t),o.d(t,{default:()=>A});var a=o(65043),n=o(50527);const r="#ffde5a";var i=o(73216),s=o(98225),l=o(85369),c=o(11906),u=o(88861),d=o(67254),f=o(46681),g=o(86213),p=o(81929),h=o.n(p),m=o(30064),b=o.n(m),v=o(1043),y=o.n(v),x=o(71935),S=o(70579);function k(e,t,o){const a=e.themes;switch(t){case"dark":a.override("color","#fff"),a.override("background-color","#000"),a.override("font-family",o);break;case"light":a.override("color","#000"),a.override("background","#fff"),a.override("font-family",o)}}const w={...n.Ko,readerArea:{...n.Ko.readerArea,transition:void 0},arrow:{...n.Ko.arrow,color:r},arrowHover:{...n.Ko.arrowHover,color:r},titleArea:{...n.Ko.titleArea,color:"black"},tocArea:{...n.Ko.tocArea,color:r},tocButtonExpanded:{...n.Ko.tocButtonExpanded,color:r},tocButtonBar:{...n.Ko.tocButtonBar,background:"black"},tocButton:{...n.Ko.tocButton,color:r}},C={...n.Ko,arrow:{...n.Ko.arrow,color:"white"},arrowHover:{...n.Ko.arrowHover,color:"yellow"},readerArea:{...n.Ko.readerArea,backgroundColor:"#000",transition:void 0},titleArea:{...n.Ko.titleArea,color:"#ccc"},tocArea:{...n.Ko.tocArea,background:"#111"},tocButtonExpanded:{...n.Ko.tocButtonExpanded,background:"#222"},tocButtonBar:{...n.Ko.tocButtonBar,background:"#fff"},tocButton:{...n.Ko.tocButton,color:"white"}},A=()=>{var e;const[t,o]=(0,a.useState)(""),[p,m]=(0,a.useState)("light"),v=(0,i.Zp)(),A=(0,a.useRef)(void 0),{id:j}=(0,i.g)(),[B,T]=(0,a.useState)(null),[L,R]=(0,a.useState)(!1),[G,K]=(0,a.useState)("en"),[E,M]=(0,a.useState)(localStorage.getItem("font")||"Georgia, serif"),[_,I]=(0,a.useState)(""),[z,N]=(0,a.useState)(null),[P,U]=(0,a.useState)(""),[H,O]=(0,a.useState)([]),[F,V]=(0,a.useState)(0),[q,D]=(0,a.useState)(!1),[W,Q]=(0,a.useState)(null),[Z,$]=(0,a.useState)(null),J=(0,a.useRef)(null),X=(0,a.useRef)(null),[Y,ee]=(0,a.useState)(""),[te,oe]=(0,a.useState)([]),ae=null===(e=s.j2.currentUser)||void 0===e?void 0:e.email;function ne(e){const t=e.start.cfi.split("/"),a=t[0]+"/"+t[1]+"/"+t[2]+"/"+t[3],n=[a,e.start.cfi.replace(a,""),e.end.cfi.replace(a,"")].join(","),r=J.current.getRange(n).toString();o(r)}function re(e,t){const o=J.current.getRange(e).toString();oe(te.concat({text:o,cfiRange:e})),J.current.annotations.add("highlight",e,{},null,"hl",{fill:"red","fill-opacity":"0.5","mix-blend-mode":"multiply"}),t.window.getSelection().removeAllRanges()}(0,a.useEffect)((()=>{if(J.current)return J.current.on("selected",re),J.current.on("relocated",ne),()=>{J.current.off("selected",re)}}),[oe,te]),(0,a.useEffect)((()=>{localStorage.setItem("font",E),A.current&&A.current.themes.override("font-family",E)}),[E]),(0,a.useEffect)((()=>{A.current&&k(A.current,p,E)}),[E]),(0,a.useEffect)((()=>{(async()=>{R(!0);try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/getEbook/".concat(j)),t=await e.json();T(t)}catch(e){console.error("Error fetching eBook content:",e.message)}finally{R(!1),(0,s.$s)(s.zS,(null===B||void 0===B?void 0:B.title)+"_reader_page_visited")}})()}),[j]),(0,a.useEffect)((()=>{A.current&&k(A.current,p)}),[p]);const[ie,se]=(0,a.useState)(null),le={backgroundColor:r,color:"black",borderRadius:"50%",padding:"10px",fontSize:"20px",position:"absolute",top:"10px",left:"10px"},ce={backgroundColor:r,color:"black",borderRadius:"50%",padding:"10px",fontSize:"20px",margin:"10px"};return(0,a.useEffect)((()=>{(e=>{if(J.current&&X.current){const{displayed:e,href:t}=J.current.location.start,o=X.current.find((e=>e.href===t));I("Page ".concat(e.page," of ").concat(e.total," in chapter ").concat(o?o.label:"n/a"))}})()}),[ie]),(0,S.jsxs)("div",{style:{height:"100vh"},children:[(0,S.jsxs)("button",{style:le,onClick:()=>v("/ebooks/".concat(j)),children:[(0,S.jsx)(l.QVr,{})," "]}),(0,S.jsxs)("button",{style:ce,onClick:()=>m("light"),children:[(0,S.jsx)(l.wQq,{})," "]}),(0,S.jsxs)("button",{style:ce,onClick:()=>m("dark"),children:[(0,S.jsx)(l.V6H,{})," "]}),(0,S.jsxs)("button",{style:ce,onClick:async()=>{$(null);const{value:e}=await b().fire({title:"Select language",html:'\n      <form id="languageForm" style="display: flex; flex-direction: column; align-items: start;">\n          <label><input type="radio" name="language" value="eng"> English</label><br>\n          <label><input type="radio" name="language" value="swh"> Swahili</label><br>\n          <label><input type="radio" name="language" value="spa"> Spanish</label><br>\n          <label><input type="radio" name="language" value="arz"> Arabic</label><br>\n          <label><input type="radio" name="language" value="fra"> French</label><br>\n          \n        </form>\n      ',focusConfirm:!1,preConfirm:()=>{const e=document.getElementById("languageForm").elements.language;let t;for(let o=0;o<e.length;o++)if(e[o].checked){t=e[o].value;break}return t}});if(e){b().fire({title:"Loading...",allowOutsideClick:!1,onBeforeOpen:()=>{b().showLoading()}});let a=B.title.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"");try{const o=(await g.A.post("https://yeeplatform.com/server/synthesize",{text:t,book_title:a,page_number:_,language:e},{timeout:6e6})).data.audio_url;$("https://yeeplatform.com/server/"+o),b().close()}catch(o){b().fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"<a href>Why do I have this issue?</a>"}),console.error("Error playing audio:",o)}}},children:[(0,S.jsx)(l.gSK,{})," "]}),(0,S.jsx)("select",{value:E,onChange:e=>M(e.target.value),children:["Georgia, serif","Arial, sans-serif","Courier New, monospace","Times New Roman, Times, serif","Verdana, Geneva, sans-serif","Tahoma, Geneva, sans-serif","Trebuchet MS, Helvetica, sans-serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Lucida Sans Unicode","Lucida Grande, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Garamond, serif","Bookman Old Style, serif","Arial Black, Gadget, sans-serif","Comic Sans MS, cursive, sans-serif","Impact, Charcoal, sans-serif","Gill Sans, sans-serif","Franklin Gothic Medium, Arial, sans-serif","Consolas, monaco, monospace","Courier, monospace","Lucida Console, Monaco, monospace","Lucida Sans Typewriter, Lucida Console, monaco, Bitstream Vera Sans Mono, monospace","American Typewriter, Georgia, serif","Andale Mono, AndaleMono, monospace","Futura, Century Gothic, AppleGothic, sans-serif","Gill Sans, Calibri, Trebuchet MS, sans-serif","Helvetica, Arial, sans-serif","Impact, Haettenschweiler, Franklin Gothic Bold, Charcoal, Helvetica Inserat, sans-serif","Lucida Grande, Lucida Sans, Lucida Sans Unicode, sans-serif","Monaco, Consolas, Lucida Console, monospace","Optima, Segoe, Candara, Calibri, Arial, sans-serif","Palatino, Palatino Linotype, Palatino LT STD, Book Antiqua, Georgia, serif","Tahoma, Verdana, Segoe, sans-serif","TimesNewRoman, Times New Roman, Times, Baskerville, Georgia, serif","Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif","Roboto, sans-serif","Montserrat, sans-serif"].map((e=>(0,S.jsx)("option",{value:e,children:e},e)))}),(0,S.jsx)(u.A,{id:"outlined-basic",label:"Search",variant:"outlined",type:"text",value:P,onChange:e=>{U(e.target.value)},style:{marginTop:"1%",marginRight:"1%"}}),(0,S.jsx)(c.A,{onClick:async()=>{if(A.current&&P){D(!0),Q(null);try{const t=await(e=P,Promise.all(A.current.book.spine.spineItems.map((t=>t.load(A.current.book.load.bind(A.current.book)).then(t.find.bind(t,e)).finally(t.unload.bind(t))))).then((e=>(A.current.annotations.remove(),e.forEach((e=>{A.current.annotations.highlight(e.cfi,{},(e=>{}))})),Promise.resolve([].concat.apply([],e))))));O(t)}catch(t){Q(t.message)}finally{D(!1)}}var e},variant:"outlined",style:{marginTop:"20px",padding:"10px"},children:"Search"}),(0,S.jsx)("div",{children:q?(0,S.jsx)("p",{children:"Searching..."}):W?(0,S.jsx)(d.A,{severity:"error",children:"Text not found please search for something else."}):H.length>0?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.A,{style:{marginRight:"1%"},onClick:()=>{const e=(F-1+H.length)%H.length,t=H[e];A.current.display(t.cfi),A.current.annotations.highlight(t.cfi,{},(e=>{})),V(e)},variant:"outlined",children:"Previous"}),(0,S.jsx)(c.A,{style:{marginRight:"1%"},onClick:()=>{const e=(F+1)%H.length,t=H[e];A.current.display(t.cfi),A.current.annotations.highlight(t.cfi,{},(e=>{})),V(e)},variant:"outlined",children:"Next"})]}):(0,S.jsx)("p",{children:"No results found"})}),Z&&(0,S.jsx)(h(),{children:(0,S.jsxs)("div",{style:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,backgroundColor:"transparent",padding:"10px",borderRadius:"10px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:[(0,S.jsx)(y(),{url:Z,controls:!0,playing:!0}),(0,S.jsx)("button",{onClick:()=>$(null),style:{marginTop:"10px",backgroundColor:"#f44336",color:"#fff",border:"none",borderRadius:"5px",padding:"5px 10px",cursor:"pointer"},children:"Cancel"})]})}),(0,S.jsx)(n.$W,{title:null===B||void 0===B?void 0:B.title,url:(null===B||void 0===B?void 0:B.ebookepubImagesUrl)||(null===B||void 0===B?void 0:B.ebook_url)||(null===B||void 0===B?void 0:B.ebookUrl),showToc:!0,location:z||ie,locationChanged:e=>se(e),epubInitOptions:{openAs:"epub"},readerStyles:"dark"===p?C:w,getRendition:e=>{k(e,p,E),A.current=e,J.current=e,J.current.themes.default({"::selection":{background:"orange"}}),oe([])},tocChanged:e=>X.current=e}),(0,S.jsx)(f.A,{handleNewUserMessage:e=>{(0,x.toggleMsgLoader)(),fetch("https://yeeplatform.com/server/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ebook_id:B._id,query:e,user_id:ae||"guest",title:B.title||"test",Description:B.Description||"test"})}).then((e=>e.json())).then((e=>{(0,x.addResponseMessage)(e.response)})).catch((e=>{console.error("Error:",e),(0,x.addResponseMessage)("Sorry, something went wrong.")})).finally((()=>{(0,x.toggleMsgLoader)()}))}})]})}}}]);
//# sourceMappingURL=5052.9ab35d88.chunk.js.map