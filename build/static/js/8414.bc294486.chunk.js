"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[8414,6446,5399],{48414:(e,t,o)=>{o.r(t),o.d(t,{default:()=>b});var a=o(65043),r=o(86213),n=o(30064),s=o.n(n),i=o(5399),l=o(22778),c=o(85865),d=o(96446),u=o(88861),h=o(10142),m=o(86032),p=o(54978),g=o(55440),f=o(63713),x=o(70579);const b=function(){const[e,t]=(0,a.useState)(null),[o,n]=(0,a.useState)(""),[b,v]=(0,a.useState)("free"),[w,y]=(0,a.useState)(!1),[j,A]=(0,a.useState)(""),[N,C]=(0,a.useState)(""),[S,k]=(0,a.useState)(!1),[I,P]=(0,a.useState)(!1),[T,U]=(0,a.useState)(0),[B,F]=(0,a.useState)(""),[L,O]=(0,a.useState)({duration:0,url:""}),[E,z]=(0,a.useState)(null),[R,M]=(0,a.useState)(null),[W,q]=(0,a.useState)({title:"",description:"",content:"",coverimage:"",type:"Audio",author_platform_id:"",categories:[],genres:[]}),D=i.auth.currentUser.uid;return(0,a.useEffect)((()=>{const e=()=>{S&&P(!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[S]),(0,x.jsxs)("div",{className:"p-8 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,x.jsx)(c.A,{variant:"h4",gutterBottom:!0,children:"Upload Audio Chapter"}),(0,x.jsxs)("form",{onSubmit:async o=>{o.preventDefault();try{if(!e||!E)return void s().fire({icon:"error",title:"Missing Files",text:"Please ensure all required files are selected."});if(P(!0),U(5),F("Well done! You're a real YeePlatform author."),!W.coverimage)return void s().fire({icon:"error",title:"Oops...",text:"Please provide a cover image."});if(W.title.length<3||W.title.length>100)return void s().fire("Error","Title should be between ".concat(3," and ").concat(100," characters."),"error");if(!(e=>e&&e.size<=157286400)(e))return void s().fire("Error","Audio file size should not exceed ".concat(150,"MB."),"error");if(W.categories.length<1)return void s().fire("Error","Please select at least ".concat(1," category(ies)."),"error");s().fire({title:"Uploading...",text:"Please wait while your chapter is being uploaded.",showConfirmButton:!1,allowOutsideClick:!1,onBeforeOpen:()=>{s().showLoading()}});const o=await(0,m.A)(W.coverimage),a=await(0,m.A)(W.coverimage,!0),l=await(0,m.A)(e),c=i.auth.currentUser;if(!c)return void s().fire({icon:"error",title:"Oops...",text:"No user logged in."});const d=await r.A.post("https://yeeplatformbackend.azurewebsites.net/AudioChapterupload/".concat(c.uid),{...W,content:l,duration:L.duration,author_platform_id:D,coverimage:o,thumbnailUrl:a});console.log("Attempting to close Swal and open dialog..."),s().close(),d.data&&d.data.message?(t(null),v("free"),A(""),C(""),q({title:"",description:"",content:"",coverimage:"",type:"Audio",author_platform_id:"",categories:[],genres:[]}),n(""),console.log("Form reset, attempting to open dialog..."),k(!0),console.log("Dialog should now be open:",w)):s().fire({icon:"error",title:"Oops...",text:"Failed to save chapter details."})}catch(a){s().fire({icon:"error",title:"Oops...",text:"Error during chapter upload."})}},children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)(g.A,{label:"Upload Cover Image:",onChange:async e=>{const t=e.target.files[0];if(t){if(!(e=>e.size/1024/1024<=5)(t))return void s().fire("Error","Image size should not exceed 5MB.","error");const e=await(e=>new Promise((t=>{const o=new Image;o.onload=()=>{t(512===o.width&&800===o.height)},o.src=URL.createObjectURL(e)})))(t);if(!e)return void s().fire("Error","Image dimensions should be exactly 512x800 pixels.","error");z(t);const o=await(0,p.yh)(t,256);M(o),A(t.name),n(URL.createObjectURL(t)),q({...W,coverimage:URL.createObjectURL(t)})}},fileName:j,accept:"image/*",required:!0}),o&&(0,x.jsx)(d.A,{component:"img",src:o,alt:"Cover Preview",sx:{width:"100%",height:"auto",maxWidth:"200px",marginTop:"10px"}})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Title:"}),(0,x.jsx)(u.A,{fullWidth:!0,variant:"outlined",type:"text",placeholder:"Title",value:W.title,onChange:e=>q({...W,title:e.target.value}),required:!0})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Categories:"}),(0,x.jsx)(l.A,{multiple:!0,id:"tags-outlined",options:["Fiction","Nonfiction","Science Fiction","Romance","Mystery/Thriller","Fantasy","Biography","History","Business/Economics","Self-help","Health/Fitness","Cooking/Food","Travel","Technology"],getOptionLabel:e=>e,filterSelectedOptions:!0,value:W.categories,onChange:(e,t)=>{q({...W,categories:t})},renderInput:e=>(0,x.jsx)(u.A,{...e,variant:"outlined",label:"Select Categories",placeholder:"Categories"})})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Monetization:"}),(0,x.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[(0,x.jsx)("option",{value:"free",children:"Free"}),(0,x.jsx)("option",{value:"notfree",children:"Not Free"})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Description:"}),(0,x.jsx)(u.A,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:W.description,onChange:e=>{e.target.value.length<=500&&q({...W,description:e.target.value})},helperText:"".concat(W.description.length,"/").concat(500),required:!0})]}),(0,x.jsx)("div",{className:"mb-4",children:(0,x.jsx)(g.A,{label:"Upload Audio File:",onChange:e=>{const o=e.target.files[0];if(o){t(o),C(o.name);const e=new Audio(URL.createObjectURL(o));e.onloadedmetadata=function(){O({...L,duration:e.duration})}}},fileName:N,accept:"audio/*",required:!0})}),S&&(0,x.jsx)(h.A,{isOpen:I,onClose:()=>P(!1),points:T,message:B}),(0,x.jsx)(f.A,{buttonText:"Upload Chapter"})]})]})}},5399:(e,t,o)=>{o.d(t,{$s:()=>r.$s,Cg:()=>d,GoogleAuthProvider:()=>n.HF,auth:()=>l,onAuthStateChanged:()=>n.hg,signInWithEmailAndPassword:()=>n.x9,signInWithPopup:()=>n.df,signOut:()=>n.CI,zS:()=>c});var a=o(37064),r=o(82413),n=o(32813);const s={apiKey:"AIzaSyBXS56tIro9cd-Sd4ySn5AwLw3T6cnMHr0",authDomain:"yeeplatform.firebaseapp.com",projectId:"yeeplatform",storageBucket:"yeeplatform.appspot.com",messagingSenderId:"272587831821",appId:"1:272587831821:web:b612b427ff43968f33f344",measurementId:"G-YZV03469PP"};let i,l,c;(async()=>{if(!i){i=(0,a.Wp)(s),l=(0,n.xI)(i);await(0,r.TT)()&&(c=(0,r.P5)(i))}})();const d=(e,t)=>{c&&(0,r.$s)(c,e,t)}},86032:(e,t,o)=>{o.d(t,{A:()=>a});const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=await fetch("https://yeeplatformbackend.azurewebsites.net/generateSasToken"),a=(await o.json()).sasToken;let r=t?"thumbnail-".concat(Date.now(),".jpg"):e.name;const n="https://yeeplatform.blob.core.windows.net/yeeebooks/".concat(r,"?").concat(a),s={method:"PUT",body:e,headers:{"x-ms-blob-type":"BlockBlob"}};if((await fetch(n,s)).ok){return n.split("?")[0]}throw new Error("Error uploading to Azure Blob Storage")}},54978:(e,t,o)=>{o.d(t,{S1:()=>s,yh:()=>n});var a=o(55861);const r=o.n(a)()(),n=(e,t)=>new Promise(((o,a)=>{const n=new FileReader;n.onload=e=>{const n=new Image;n.onload=()=>{const e=t/n.width,s=n.height*e,i=document.createElement("canvas");i.width=t,i.height=s,r.resize(n,i).then((e=>r.toBlob(e,"image/jpeg",.8))).then((e=>o(e))).catch((e=>a(e)))},n.src=e.target.result},n.onerror=a,n.readAsDataURL(e)})),s=(e,t,o)=>{const a=e.size/1048576;return a>=t&&a<=o}},63713:(e,t,o)=>{o.d(t,{A:()=>r});o(65043);var a=o(70579);const r=function(e){let{buttonText:t}=e;return(0,a.jsx)("button",{type:"submit",className:"bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:shadow-outline",children:t})}},10142:(e,t,o)=>{o.d(t,{A:()=>u});var a=o(65043),r=o(90035),n=o(29347),s=o(35316),i=o(26600),l=o(11906),c=o(12707),d=o(70579);const u=function(e){let{isOpen:t,onClose:u,points:h,message:m}=e;const p=a.lazy((()=>Promise.resolve().then(o.t.bind(o,93750,23))));return(0,d.jsxs)(r.A,{open:t,onClose:u,children:[(0,d.jsx)(i.A,{className:"text-center",children:"Success!"}),(0,d.jsxs)(s.A,{className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)(a.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading..."}),children:(0,d.jsx)(p,{animationData:c,style:{width:"auto",maxWidth:"100%",height:200}})}),(0,d.jsx)("p",{children:m}),(0,d.jsxs)("div",{className:"text-center animate-pulse",children:[(0,d.jsx)("p",{className:"text-yellow-500 font-bold text-xl",children:"You've got"}),(0,d.jsxs)("span",{className:"text-4xl text-yellow-500",children:[h," Points!"]})]}),(0,d.jsx)("p",{children:"Your content will be available in the marketplace soon."})]}),(0,d.jsx)(n.A,{children:(0,d.jsx)(l.A,{onClick:u,color:"primary",children:"Close"})})]})}},55440:(e,t,o)=>{o.d(t,{A:()=>n});o(65043);var a=o(62954),r=o(70579);const n=function(e){let{label:t,onChange:o,fileName:n,accept:s,required:i}=e;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:t}),(0,r.jsxs)("label",{className:"w-full flex items-center px-4 py-2 rounded-lg shadow-lg tracking-wide uppercase border cursor-pointer hover:bg-yellow-500 hover:text-white ".concat(n?"bg-yellow-500 text-white":"bg-white text-yellow-500 border-yellow-500"),children:[(0,r.jsx)(a.A,{className:"mr-2"}),n||"Choose File",(0,r.jsx)("input",{type:"file",onChange:o,className:"hidden",accept:s,required:i})]})]})}},96446:(e,t,o)=>{o.d(t,{A:()=>v});var a=o(58168),r=o(98587),n=o(65043),s=o(91576),i=o(68131),l=o(58812),c=o(18698),d=o(45527),u=o(70579);const h=["className","component"];var m=o(25430),p=o(88279),g=o(13375);const f=(0,o(57056).A)("MuiBox",["root"]),x=(0,p.A)(),b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:o,defaultClassName:m="MuiBox-root",generateClassName:p}=e,g=(0,i.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.A);return n.forwardRef((function(e,n){const i=(0,d.A)(o),l=(0,c.A)(e),{className:f,component:x="div"}=l,b=(0,r.A)(l,h);return(0,u.jsx)(g,(0,a.A)({as:x,ref:n,className:(0,s.A)(f,p?p(m):m),theme:t&&i[t]||i},b))}))}({themeId:g.A,defaultTheme:x,defaultClassName:f.root,generateClassName:m.A.generate}),v=b},91576:(e,t,o)=>{function a(e){var t,o,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(o=a(e[t]))&&(r&&(r+=" "),r+=o)}else for(o in e)e[o]&&(r&&(r+=" "),r+=o);return r}o.d(t,{A:()=>r});const r=function(){for(var e,t,o=0,r="",n=arguments.length;o<n;o++)(e=arguments[o])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}}}]);
//# sourceMappingURL=8414.bc294486.chunk.js.map