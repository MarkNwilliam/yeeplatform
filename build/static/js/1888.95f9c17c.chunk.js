"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[1888,5399],{1888:(e,t,o)=>{o.r(t),o.d(t,{default:()=>y});var a=o(65043),r=o(86213),n=o(30064),s=o.n(n),i=o(5399),l=o(85865),c=o(96446),d=o(43845),u=o(22778),p=o(88861),h=o(86032),m=o(10142),f=o(55440),x=o(63713),g=o(54978),b=o(70579);const y=function(e){let{user:t}=e;const[o,n]=(0,a.useState)(null),[y,w]=(0,a.useState)(null),[v,j]=(0,a.useState)(""),[N,k]=(0,a.useState)(""),[S,A]=(0,a.useState)("Well done! You're a real YeePlatform author."),[C,z]=(0,a.useState)(100),[B,P]=(0,a.useState)(null),[E,I]=(0,a.useState)(""),[F,U]=(0,a.useState)(""),[O,T]=(0,a.useState)(""),[M,D]=(0,a.useState)(""),[L,q]=(0,a.useState)(""),[R,W]=(0,a.useState)(""),[Y,H]=(0,a.useState)(""),[$,K]=(0,a.useState)(!1),[G,X]=(0,a.useState)(""),[_,V]=(0,a.useState)([]),[Z,J]=(0,a.useState)(!1),[Q,ee]=(0,a.useState)(null);(0,a.useEffect)((()=>{const e=()=>{Z&&J(!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[Z]);const te=300,oe=i.auth.currentUser.uid,ae=(e,t)=>{const o=e.name.split(".").pop();return t.includes(o)},re=(e,t,o)=>{const a=e.size/1048576;return a>=t&&a<=o},ne=async(e,t,o)=>new Promise((a=>{const r=new Image;r.onload=()=>{a(r.width===t&&r.height===o)},r.src=URL.createObjectURL(e)}));return(0,b.jsxs)("div",{className:"p-8 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,b.jsx)(l.A,{variant:"h4",className:"text-center mb-6",children:"Upload your Ebook"}),(0,b.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),F.length>100)return void s().fire("Error","Title is too long.","error");if(O.length>500)return void s().fire("Error","Description is too long.","error");if(Y.length>200)return void s().fire("Error","Subtitle is too long.","error");if(o&&o.size/1024/1024>te)return void s().fire("Error","eBook file size is too large.","error");if(s().fire({icon:"info",title:"Uploading...",text:"Please wait while your file is being uploaded.",showConfirmButton:!1,allowOutsideClick:!1}),!F.trim())return void s().fire({icon:"error",title:"Oops...",text:"The title cannot be empty. Please provide a title and try again."});if(!ae(o,["pdf","epub","mobi"]))return void s().fire({icon:"error",title:"Oops...",text:"Invalid eBook format. Please upload in .pdf, .epub, or .mobi format."});await ne(y,600,800);if(!re(o,.1,200))return void s().fire({icon:"error",title:"Oops...",text:"eBook size should be between 100KB and 200MB. Please adjust the file size and try again."});if(!re(y,.001,5))return void s().fire({icon:"error",title:"Oops...",text:"Cover image size should be between 1KB and 5MB. Please adjust the file size and try again."});if(!ae(y,["jpg","jpeg","png"]))return void s().fire({icon:"error",title:"Oops...",text:"Invalid cover image format. Please upload in .jpg or .png format."});if(!(O.split(/\s+/).length<=300))return void s().fire({icon:"error",title:"Oops...",text:"Description exceeds 300 words. Please shorten it and try again."});if(!(e=>/^(97(8|9))?\d{9}(\d|X)$/.test(e))(L)&&L)return void s().fire({icon:"error",title:"Oops...",text:"Invalid ISBN format. Please check and try again."});const t=await(0,g.yh)(y,256),a=await(0,h.A)(y),i=await(0,h.A)(t,!0),l=await(0,h.A)(B);if(!a||!i)throw new Error("Failed to get valid URLs for the files.");let c;if("application/pdf"===o.type){const e=new FormData;e.append("ebookFile",o);try{c=(await r.A.post("https://yeeplatformbackend.azurewebsites.net/fileupload/".concat(oe),e,{headers:{"Content-Type":"multipart/form-data"}})).data.azureFileUrl}catch(u){return console.error("Error uploading the ebook:",u),void s().fire({icon:"error",title:"Oops...",text:"Error uploading the ebook. Please try again."})}}else{if("application/epub+zip"!==o.type)return void s().fire({icon:"error",title:"Oops...",text:"Invalid eBook format. Please upload in .pdf or .epub format."});c=(await(0,h.A)(o)).url}const d=new FormData;d.append("coverUrl",a),d.append("thumbnailUrl",i),d.append("title",F),d.append("description",O),d.append("categories",_),d.append("isbn",L),d.append("previewUrl",l),d.append("subtitle",Y),d.append("monetization",$),d.append("publicationDate",R),d.append("author_platform_id",oe),d.append("ebookUrl",c);try{const e=await r.A.post("https://yeeplatformbackend.azurewebsites.net/ebookupload/".concat(oe),d);console.log(e.data),s().close(),n(null),w(null),j(""),k(""),U(""),T(""),H(""),D(""),q(""),W(""),X(""),T(""),V([]),P(null),I(""),J(!0)}catch(u){console.error("Error uploading the ebook:",u),s().fire({icon:"error",title:"Oops...",text:"Error uploading the ebook. Please try again."})}},encType:"multipart/form-data",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Title:"}),(0,b.jsx)("input",{type:"text",value:F,onChange:e=>{e.target.value.length<=100&&U(e.target.value)},className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0}),(0,b.jsxs)("div",{className:"text-right text-sm",children:[F.length,"/",100]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Subtitle:"}),(0,b.jsx)("input",{type:"text",value:Y,onChange:e=>{e.target.value.length<=200&&H(e.target.value)},className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"}),(0,b.jsxs)("div",{className:"text-right text-sm",children:[Y.length,"/",200]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Upload Cover Image (Max size: ",5,"MB):"]}),(0,b.jsx)(f.A,{onChange:async e=>{const t=e.target.files[0];if(t){if(!re(t,.001,5))return void s().fire("Error","Cover image size should not exceed ".concat(5," MB."),"error");if(!await ne(t,512,800))return void s().fire("Error","Invalid image dimensions.","error");try{const e=await(0,g.yh)(t,256),o=new File([e],t.name,{type:"image/jpeg"});w(o),k(o.name),X(URL.createObjectURL(e))}catch(o){console.error("Error resizing image:",o),s().fire("Error","Failed to resize the image.","error")}}},fileName:N,accept:".jpg, .jpeg, .png",required:!0}),G&&(0,b.jsx)(c.A,{component:"img",sx:{height:240,width:180,maxHeight:{xs:233,md:167},maxWidth:{xs:350,md:250},objectFit:"cover"},alt:"Cover Preview",src:G})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(u.A,{multiple:!0,id:"categories-autocomplete",options:["Fiction","Nonfiction","Science Fiction","Romance","Mystery/Thriller","Fantasy","Biography","History","Business/Economics","Self-help","Health/Fitness","Cooking/Food","Travel","Technology"],value:_,onChange:(e,t)=>{if(Array.isArray(t)){if(t.length>3)return void s().fire("Error","You can select up to 3 categories only.","error");V(t)}else console.error("Expected an array for selected categories, received:",t)},renderInput:e=>(0,b.jsx)(p.A,{...e,label:"Categories",placeholder:"Select categories"}),renderTags:(e,t)=>e.map(((e,o)=>(0,b.jsx)(d.A,{label:e,...t({index:o})},e)))})}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Description:"}),(0,b.jsx)("textarea",{value:O,onChange:e=>T(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",maxLength:500,required:!0}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[O.length," / ",500," characters"]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"ISBN(Optional):"}),(0,b.jsx)("input",{type:"text",value:L,onChange:e=>q(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Publication Date:"}),(0,b.jsx)("input",{type:"date",value:R,onChange:e=>W(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Monetization:"}),(0,b.jsxs)("select",{value:$?"notfree":"free",onChange:e=>{K("notfree"===e.target.value)},className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[(0,b.jsx)("option",{value:"free",children:"Free"}),(0,b.jsx)("option",{value:"notfree",children:"Not Free"})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Upload eBook Previewn (Max size: ",10,"MB):"]}),(0,b.jsx)(f.A,{onChange:async e=>{const t=e.target.files[0];if(t){if(!re(t,.1,10))return void s().fire("Error","Preview file size should not exceed ".concat(10," MB."),"error");P(t),I(t.name)}},fileName:E,accept:".pdf, .epub, .mobi",required:!0})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:["Upload eBook File (Max size: ",te,"MB):"]}),(0,b.jsx)(f.A,{onChange:e=>{const t=e.target.files[0];if(t){if(!re(t,.1,te))return void s().fire("Error","eBook file size should not exceed ".concat(te," MB."),"error");n(t),j(t.name)}},fileName:v,accept:".pdf, .epub, .mobi",required:!0})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(x.A,{buttonText:"Upload"})})]}),Z&&(0,b.jsx)(m.A,{isOpen:Z,onClose:()=>J(!1),points:C,message:S})]})}},5399:(e,t,o)=>{o.d(t,{$s:()=>r.$s,Cg:()=>d,GoogleAuthProvider:()=>n.HF,auth:()=>l,onAuthStateChanged:()=>n.hg,signInWithEmailAndPassword:()=>n.x9,signInWithPopup:()=>n.df,signOut:()=>n.CI,zS:()=>c});var a=o(37064),r=o(82413),n=o(32813);const s={apiKey:"AIzaSyBXS56tIro9cd-Sd4ySn5AwLw3T6cnMHr0",authDomain:"yeeplatform.firebaseapp.com",projectId:"yeeplatform",storageBucket:"yeeplatform.appspot.com",messagingSenderId:"272587831821",appId:"1:272587831821:web:b612b427ff43968f33f344",measurementId:"G-YZV03469PP"};let i,l,c;(async()=>{if(!i){i=(0,a.Wp)(s),l=(0,n.xI)(i);await(0,r.TT)()&&(c=(0,r.P5)(i))}})();const d=(e,t)=>{c&&(0,r.$s)(c,e,t)}},86032:(e,t,o)=>{o.d(t,{A:()=>a});const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=await fetch("https://yeeplatformbackend.azurewebsites.net/generateSasToken"),a=(await o.json()).sasToken;let r=t?"thumbnail-".concat(Date.now(),".jpg"):e.name;const n="https://yeeplatform.blob.core.windows.net/yeeebooks/".concat(r,"?").concat(a),s={method:"PUT",body:e,headers:{"x-ms-blob-type":"BlockBlob"}};if((await fetch(n,s)).ok){return n.split("?")[0]}throw new Error("Error uploading to Azure Blob Storage")}},54978:(e,t,o)=>{o.d(t,{S1:()=>s,yh:()=>n});var a=o(55861);const r=o.n(a)()(),n=(e,t)=>new Promise(((o,a)=>{const n=new FileReader;n.onload=e=>{const n=new Image;n.onload=()=>{const e=t/n.width,s=n.height*e,i=document.createElement("canvas");i.width=t,i.height=s,r.resize(n,i).then((e=>r.toBlob(e,"image/jpeg",.8))).then((e=>o(e))).catch((e=>a(e)))},n.src=e.target.result},n.onerror=a,n.readAsDataURL(e)})),s=(e,t,o)=>{const a=e.size/1048576;return a>=t&&a<=o}},63713:(e,t,o)=>{o.d(t,{A:()=>r});o(65043);var a=o(70579);const r=function(e){let{buttonText:t}=e;return(0,a.jsx)("button",{type:"submit",className:"bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:shadow-outline",children:t})}},10142:(e,t,o)=>{o.d(t,{A:()=>u});var a=o(65043),r=o(90035),n=o(29347),s=o(35316),i=o(26600),l=o(11906),c=o(12707),d=o(70579);const u=function(e){let{isOpen:t,onClose:u,points:p,message:h}=e;const m=a.lazy((()=>Promise.resolve().then(o.t.bind(o,93750,23))));return(0,d.jsxs)(r.A,{open:t,onClose:u,children:[(0,d.jsx)(i.A,{className:"text-center",children:"Success!"}),(0,d.jsxs)(s.A,{className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)(a.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading..."}),children:(0,d.jsx)(m,{animationData:c,style:{width:"auto",maxWidth:"100%",height:200}})}),(0,d.jsx)("p",{children:h}),(0,d.jsxs)("div",{className:"text-center animate-pulse",children:[(0,d.jsx)("p",{className:"text-yellow-500 font-bold text-xl",children:"You've got"}),(0,d.jsxs)("span",{className:"text-4xl text-yellow-500",children:[p," Points!"]})]}),(0,d.jsx)("p",{children:"Your content will be available in the marketplace soon."})]}),(0,d.jsx)(n.A,{children:(0,d.jsx)(l.A,{onClick:u,color:"primary",children:"Close"})})]})}},55440:(e,t,o)=>{o.d(t,{A:()=>n});o(65043);var a=o(62954),r=o(70579);const n=function(e){let{label:t,onChange:o,fileName:n,accept:s,required:i}=e;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:t}),(0,r.jsxs)("label",{className:"w-full flex items-center px-4 py-2 rounded-lg shadow-lg tracking-wide uppercase border cursor-pointer hover:bg-yellow-500 hover:text-white ".concat(n?"bg-yellow-500 text-white":"bg-white text-yellow-500 border-yellow-500"),children:[(0,r.jsx)(a.A,{className:"mr-2"}),n||"Choose File",(0,r.jsx)("input",{type:"file",onChange:o,className:"hidden",accept:s,required:i})]})]})}}}]);
//# sourceMappingURL=1888.95f9c17c.chunk.js.map