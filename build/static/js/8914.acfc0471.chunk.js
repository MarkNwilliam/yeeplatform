"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[8914],{18914:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var i=r(72791),n=r(20890),o=r(39281),s=r(35527),c=r(79836),a=r(56890),d=r(35855),l=r(53994),h=r(53382),u=r(94294),p=r(5289),x=r(10387),j=r(39157),f=r(51691),Z=r(40412),g=r(97123),w=r(61567),y=r(21830),m=r.n(y),C=r(80184);const k=()=>{const[e,t]=(0,i.useState)([]),[r,y]=(0,i.useState)(!1),[k,v]=(0,i.useState)(""),[b,E]=(0,i.useState)([]),[S,A]=(0,i.useState)(null),[T,D]=(0,i.useState)(null),[B,L]=(0,i.useState)(""),[z,N]=(0,i.useState)(!1),[O,_]=(0,i.useState)(""),F=async()=>{const e=w.I8.currentUser;if(e)try{const r=await fetch("https://yeeplatformbackend.azurewebsites.net/getauthorchapter/".concat(e.uid));if(!r.ok){const e=await r.json();throw new Error(e.message||"An error occurred while fetching the chapters.")}const i=await r.json();t(i),v("")}catch(k){console.error("Error fetching text chapters:",k),v(k.toString()),t([])}else v("No user found in auth.")},U=async()=>{const e=w.I8.currentUser;if(e)try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/getAudioChapters/".concat(e.uid));if(!t.ok){const e=await t.json();throw new Error(e.message||"An error occurred while fetching the audio chapters.")}const r=await t.json();E(r),v("")}catch(k){console.error("Error fetching audio chapters:",k),v(k.toString()),E([])}else v("No user found in auth.")},Y=()=>{F(),U()};(0,i.useEffect)((()=>{F(),U()}),[]);const P=()=>{y(!1)},I=async function(r){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((async n=>{if(n.isConfirmed){m().showLoading();try{const n=i?"https://yeeplatformbackend.azurewebsites.net/deleteaudiochapter/".concat(r):"https://yeeplatformbackend.azurewebsites.net/deletechapter/".concat(r);if(!(await fetch(n,{method:"DELETE"})).ok)throw new Error("Failed to delete the chapter.");Y(),i?E(b.filter((e=>e.id!==r))):t(e.filter((e=>e.id!==r))),m().hideLoading(),m().fire("Deleted!","Your file has been deleted.","success")}catch(k){m().hideLoading(),m().fire("Error!","There was an issue deleting your chapter.","error"),console.error("Error deleting chapter:",k)}}}))};return(0,C.jsxs)("div",{children:[(0,C.jsx)(n.Z,{variant:"h4",component:"h2",children:"My Chapters"}),(0,C.jsx)(o.Z,{component:s.Z,children:(0,C.jsxs)(c.Z,{children:[(0,C.jsx)(a.Z,{children:(0,C.jsxs)(d.Z,{children:[(0,C.jsx)(l.Z,{children:"Book Title"}),(0,C.jsx)(l.Z,{children:"Description"}),(0,C.jsx)(l.Z,{children:"Actions"})]})}),(0,C.jsx)(h.Z,{children:e.map((e=>(0,C.jsxs)(d.Z,{children:[(0,C.jsx)(l.Z,{children:e.title}),(0,C.jsx)(l.Z,{children:e.description}),(0,C.jsxs)(l.Z,{children:[(0,C.jsx)(u.Z,{onClick:()=>((e,t)=>{console.log("Opening chapter for edit:",e),A(e),L(t),y(!0)})(e,e._id),children:"Edit"}),(0,C.jsx)(u.Z,{onClick:()=>I(e._id),children:"Delete"})]})]},e._id)))}),0===e.length&&(0,C.jsx)(n.Z,{variant:"h6",style:{textAlign:"center",padding:"20px",color:"grey"},children:"No data available."})]})}),(0,C.jsx)(n.Z,{variant:"h4",component:"h2",style:{marginTop:"20px"},children:"My Audio Chapters"}),(0,C.jsxs)(o.Z,{component:s.Z,children:[(0,C.jsxs)(c.Z,{children:[(0,C.jsx)(a.Z,{children:(0,C.jsxs)(d.Z,{children:[(0,C.jsx)(l.Z,{children:"Book Title"}),(0,C.jsx)(l.Z,{children:"Duration"}),(0,C.jsx)(l.Z,{children:"Description"}),(0,C.jsx)(l.Z,{children:"Audio File"}),(0,C.jsx)(l.Z,{children:"Actions"})]})}),(0,C.jsx)(h.Z,{children:b.map((e=>(0,C.jsxs)(d.Z,{children:[(0,C.jsx)(l.Z,{children:e.title}),(0,C.jsx)(l.Z,{children:e.duration}),(0,C.jsx)(l.Z,{children:e.description}),(0,C.jsx)(l.Z,{children:(0,C.jsxs)("audio",{controls:!0,onError:e=>console.log("Error playing audio:",e),children:[(0,C.jsx)("source",{src:e.content,type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),(0,C.jsxs)(l.Z,{children:[(0,C.jsx)(u.Z,{onClick:()=>{return t=e,r=e._id,D(t),_(r),void N(!0);var t,r},children:"Edit"}),(0,C.jsx)(u.Z,{onClick:()=>I(e._id,!0),children:"Delete"})]})]},e._id)))})]}),0===b.length&&(0,C.jsx)(n.Z,{variant:"h6",style:{textAlign:"center",padding:"20px",color:"grey"},children:"No audio data available."})]}),(0,C.jsxs)(p.Z,{open:r,onClose:P,children:[(0,C.jsx)(x.Z,{children:"Edit Chapter"}),(0,C.jsxs)(j.Z,{children:[(0,C.jsx)(f.Z,{children:"Please edit the chapter information."}),(0,C.jsx)(Z.Z,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,multiline:!0,rows:10,value:(null===S||void 0===S?void 0:S.description)||"",onChange:e=>{A({...S,description:e.target.value})}})]}),(0,C.jsxs)(g.Z,{children:[(0,C.jsx)(u.Z,{onClick:P,children:"Cancel"}),(0,C.jsx)(u.Z,{onClick:async()=>{m().fire({title:"Saving chapter...",onBeforeOpen:()=>{m().showLoading()},allowOutsideClick:()=>!m().isLoading()});try{if(!(await fetch("https://yeeplatformbackend.azurewebsites.net/updatechapter/".concat(B),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to update the chapter.");y(!1),m().fire("Success","Chapter updated successfully","success"),Y()}catch(k){console.error("Error updating chapter:",k),m().fire("Error","There was a problem saving the chapter","error")}},children:"Save"})]})]}),(0,C.jsxs)(p.Z,{open:z,onClose:()=>N(!1),children:[(0,C.jsx)(x.Z,{children:"Edit Audio Chapter"}),(0,C.jsx)(j.Z,{children:(0,C.jsx)(Z.Z,{margin:"dense",id:"description",label:"Description",multiline:!0,rows:4,type:"text",fullWidth:!0,value:(null===T||void 0===T?void 0:T.description)||"",onChange:e=>((e,t)=>{D({...T,[t]:e.target.value})})(e,"description")})}),(0,C.jsxs)(g.Z,{children:[(0,C.jsx)(u.Z,{onClick:()=>N(!1),children:"Cancel"}),(0,C.jsx)(u.Z,{onClick:async()=>{m().fire({title:"Saving Audio Chapter...",didOpen:()=>{m().showLoading()}});try{const e={description:T.description},t=await fetch("https://yeeplatformbackend.azurewebsites.net/updateAudioChapter/".concat(O),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to update the audio chapter.")}N(!1),m().fire("Success!","Audio chapter updated successfully.","success"),Y()}catch(k){m().fire("Error!","There was an issue saving your audio chapter: ".concat(k.message),"error"),console.error("Error updating audio chapter:",k)}},children:"Save"})]})]})]})}}}]);
//# sourceMappingURL=8914.acfc0471.chunk.js.map