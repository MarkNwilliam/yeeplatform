"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[4026],{84026:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var o=n(65043),r=n(73216),i=n(73237),a=n(64980),s=n(86691),d=n(98225),c=n(46749),l=n(56409),u=(n(89709),n(91148),n(85369)),p=n(30064),h=n.n(p),f=n(41591),x=(n(48698),n(8606)),g=n(39085),v=n(68016),m=n(81637),y=n(85865),w=n(96446),j=n(67254),b=n(70579);const S=function(){const{id:e}=(0,r.g)(),[t,n]=(0,o.useState)(!1),[p,S]=(0,o.useState)(null),[k,C]=(0,o.useState)(null),[I,P]=(0,o.useState)([]),[M,O]=(0,o.useState)(0),{speak:_,cancel:A}=(0,x.o3)(),[E,R]=(0,o.useState)(!1),[T,D]=(0,o.useState)(""),[F,z]=(0,o.useState)(!1),[N,L]=(0,o.useState)(1),[V,B]=(0,o.useState)(!1),J=()=>{B(!0)},Y=()=>{B(!1)},U=(0,r.Zp)(),W=(0,s.A)("(max-width:626px)"),Z=(0,s.A)("(max-width:400px)"),G=W?.8:1,q=Z?"wrap":"nowrap";function H(e){return(0,b.jsxs)(w.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,b.jsx)(m.A,{variant:"determinate",...e}),(0,b.jsx)(w.A,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)(y.A,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(e.value),"%")})})]})}(0,o.useEffect)((()=>{(async()=>{n(!0);try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/getChapter/".concat(e),{cache:"force-cache"});if(!t.ok)return void console.error("Response not OK:",t);const n=await t.json();C(n),S(null===n||void 0===n?void 0:n.doc_location)}catch(t){console.error("Error fetching eBook content:",t.message)}finally{n(!1)}})()}),[e]);const K=async()=>{if(!t&&k)try{if(E)A(),R(!1);else{ee();window.speechSynthesis.getVoices();const e=await(async()=>{const e=await(0,c.getDocument)(p).promise,t=await e.getPage(N+1);return(await t.getTextContent()).items.map((e=>e.str)).join(" ")})();_({text:e,rate:.9}),D(e),h().close(),te(),R(!0)}}catch(e){h().close(),console.error("Error extracting page text:",e)}},Q=(0,l.scrollModePlugin)(),{SwitchScrollModeButton:X}=Q,$=(0,a.defaultLayoutPlugin)({sidebarTabs:e=>[e[0],e[1]],renderToolbar:e=>(0,b.jsx)(e,{children:e=>{const{CurrentPageInput:t,SwitchTheme:n,EnterFullScreen:o,GoToNextPage:r,GoToPreviousPage:a,NumberOfPages:s,SwitchScrollModeMenuItem:d,ShowSearchPopover:c,SwitchScrollMode:l,Zoom:p,ZoomIn:h,ZoomOut:f}=e;return(0,b.jsxs)("div",{style:{alignItems:"center",display:"flex",flexWrap:{defaultWrap:q},justifyContent:"space-between",width:"100%",height:"auto",backgroundColor:"#ffde5a",padding:"10px"},children:[(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)("button",{onClick:()=>U("/chapters"),children:(0,b.jsx)(u.QVr,{})})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(c,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(f,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(p,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(h,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px",marginLeft:"auto"},children:(0,b.jsx)(a,{})}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"0px 2px"},children:[(0,b.jsx)(t,{})," / ",(0,b.jsx)(s,{})]}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(r,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)("button",{onClick:K,children:(0,b.jsx)(u.gSK,{})})}),!W&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{padding:"0px 2px",marginLeft:"auto"},children:(0,b.jsx)(o,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px",marginLeft:"auto"},children:(0,b.jsx)(n,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Vertical})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Horizontal})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Wrapped})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Page})})]}),W&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.A,{onClick:J,children:"Options"}),(0,b.jsxs)(g.Ay,{anchor:"right",open:V,onClose:Y,children:[(0,b.jsx)("div",{style:{padding:"0px 2px",marginLeft:"auto"},children:(0,b.jsx)(o,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px",marginLeft:"auto"},children:(0,b.jsx)(n,{})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Vertical})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Horizontal})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Wrapped})}),(0,b.jsx)("div",{style:{padding:"0px 2px"},children:(0,b.jsx)(X,{mode:i.ScrollMode.Page})})]})]})]})}})}),ee=()=>{h().fire({title:"Loading",showClass:{popup:"\n            animate__animated\n            animate__fadeInUp\n            animate__faster\n          "},hideClass:{popup:"\n            animate__animated\n            animate__fadeOutDown\n            animate__faster\n          "},html:"Processing your request...",allowOutsideClick:!1,showConfirmButton:!1,onBeforeOpen:()=>{h().showLoading()}})},te=()=>{R(!0),h().fire({title:"Playing",html:"Text is being played...",showCancelButton:!0,showConfirmButton:!1,cancelButtonText:"Stop",allowOutsideClick:!1,cancelButtonClass:"#ffff00",didClose:()=>{R(!1)}}).then((e=>{e.dismiss===h().DismissReason.cancel&&A()}))},ne=async()=>{const e=JSON.parse(localStorage.getItem("ebookData"));if(e&&e.read)try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/updateViewedBooks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.j2.currentUser.uid,bookId:e.id})});await t.json()}catch(t){console.error("Error updating viewed books:",t)}},oe=async()=>{const e=JSON.parse(localStorage.getItem("ebookData"));if(e)try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/updateEbookScores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.j2.currentUser.uid,bookId:e.id,score:e.percentageVisited})});await t.json()}catch(t){console.error("Error updating ebook scores:",t)}},re=async()=>{try{const e=localStorage.getItem("ebookID"),t=(localStorage.getItem("viewed"),await fetch("https://yeeplatformbackend.azurewebsites.net/recordEbookView",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.j2.currentUser.uid,ebookId:e})}));await t.json()}catch(e){console.error("Error recording ebook view:",e)}};return(0,b.jsxs)("div",{style:{height:"100vh",width:"100%"},children:[k&&(0,b.jsxs)(f.m,{children:[(0,b.jsx)("title",{children:(null===k||void 0===k?void 0:k.title)||"Ebook Reader - Yee FM"}),(0,b.jsx)("meta",{name:"description",content:(null===k||void 0===k?void 0:k.description)||"Read your favorite ebooks on Yee FM."}),(0,b.jsx)("meta",{name:"keywords",content:"Yee FM, ebooks, reading, literature, digital library"}),(0,b.jsx)("link",{rel:"icon",href:(null===k||void 0===k?void 0:k.coverImage)||(null===k||void 0===k?void 0:k.coverimage)||"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp"}),(0,b.jsx)("meta",{property:"og:title",content:(null===k||void 0===k?void 0:k.title)||"Ebook Reader - Yee FM"}),(0,b.jsx)("meta",{property:"og:description",content:(null===k||void 0===k?void 0:k.description)||"Read your favorite ebooks on Yee FM."}),(0,b.jsx)("meta",{property:"og:image",content:(null===k||void 0===k?void 0:k.coverImage)||(null===k||void 0===k?void 0:k.coverimage)||"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp"}),(0,b.jsx)("meta",{property:"og:type",content:"book"}),(0,b.jsx)("meta",{property:"og:url",content:window.location.href})]}),(0,b.jsx)("style",{jsx:!0,children:"\n      @media only screen and (max-width: 500px) {\n        /* Styles for mobile devices */\n        .pdf-viewer {\n          width: 100%;\n          height: auto;\n        }\n      }\n\n      .rpv-core__viewer--loading .rpv-core__viewer-document {\n        visibility: hidden;\n      }\n    "}),t?(0,b.jsx)("div",{children:"Loading..."}):p?(0,b.jsx)(i.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,b.jsx)(i.Viewer,{transformGetDocumentParams:e=>Object.assign({},e,{url:p,disableRange:!1,disableStream:!1,rangeChunkSize:65536,disableAutoFetch:!1,disableFontFace:!0}),scrollMode:i.ScrollMode.Page,defaultScale:G,onPageChange:async t=>{let{currentPage:n}=t;L(n),P([...I,n]);const o=new Set(I).size,r=o/M*100;r>=30&&(await ne(),await oe());const i={id:e,pageNumbers:I,uniquePageCount:o,percentageVisited:r,read:r>=30};localStorage.setItem("ebookData",JSON.stringify(i));JSON.parse(localStorage.getItem("ebookData"))},onDocumentLoad:t=>{let{doc:n}=t;O(n.numPages),localStorage.getItem("ebookID")!==e&&(localStorage.setItem("ebookID",e),localStorage.setItem("viewed","true"),re())},renderLoader:e=>(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-yellow-500 font-bold",children:"Please wait, it's coming..."}),(0,b.jsx)("div",{style:{width:"100%"},children:(0,b.jsx)(H,{value:Math.round(e)})})]}),plugins:[$,Q]})}):(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,b.jsx)(j.A,{severity:"error",children:"No PDF found."})})})]})}},8606:(e,t,n)=>{var o=n(87216);var r=n(38441);function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"o3",{enumerable:!0,get:function(){return i(r).default}})},87216:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(d){r=!0,i=d}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=n(65043);var i=function(e,t){var n=(0,r.useRef)((function(){throw new Error("Cannot call an event handler while rendering.")}));return(0,r.useEffect)((function(){n.current=e}),[e].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))),(0,r.useCallback)((function(e){return(0,n.current)(e)}),[n])};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onEnd,n=void 0===t?function(){}:t,a=e.onResult,s=void 0===a?function(){}:a,d=e.onError,c=void 0===d?function(){}:d,l=(0,r.useRef)(null),u=(0,r.useState)(!1),p=o(u,2),h=p[0],f=p[1],x=(0,r.useState)(!1),g=o(x,2),v=g[0],m=g[1],y=function(e){var t=Array.from(e.results).map((function(e){return e[0]})).map((function(e){return e.transcript})).join("");s(t)},w=function(e){"not-allowed"===e.error&&(l.current.onend=function(){},f(!1)),c(e)},j=i((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!h&&v){var t=e.lang,n=void 0===t?"":t,o=e.interimResults,r=void 0===o||o,i=e.continuous,a=void 0!==i&&i,s=e.maxAlternatives,d=void 0===s?1:s,c=e.grammars;f(!0),l.current.lang=n,l.current.interimResults=r,l.current.onresult=y,l.current.onerror=w,l.current.continuous=a,l.current.maxAlternatives=d,c&&(l.current.grammars=c),l.current.onend=function(){return l.current.start()},l.current.start()}}),[h,v,l]),b=i((function(){h&&v&&(l.current.onresult=function(){},l.current.onend=function(){},l.current.onerror=function(){},f(!1),l.current.stop(),n())}),[h,v,l,n]);return(0,r.useEffect)((function(){"undefined"!==typeof window&&(window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition,window.SpeechRecognition&&(m(!0),l.current=new window.SpeechRecognition))}),[]),{listen:j,listening:h,stop:b,supported:v}}},38441:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(d){r=!0,i=d}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=n(65043);t.default=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onEnd,t=void 0===e?function(){}:e,n=(0,r.useState)([]),i=o(n,2),a=i[0],s=i[1],d=(0,r.useState)(!1),c=o(d,2),l=c[0],u=c[1],p=(0,r.useState)(!1),h=o(p,2),f=h[0],x=h[1],g=function(e){s(e)},v=function(){u(!1),t()};(0,r.useEffect)((function(){"undefined"!==typeof window&&window.speechSynthesis&&(x(!0),function(){var e=window.speechSynthesis.getVoices();e.length>0?g(e):window.speechSynthesis.onvoiceschanged=function(t){e=t.target.getVoices(),g(e)}}())}),[]);return{supported:f,speak:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.voice,n=void 0===t?null:t,o=e.text,r=void 0===o?"":o,i=e.rate,a=void 0===i?1:i,s=e.pitch,d=void 0===s?1:s,c=e.volume,l=void 0===c?1:c;if(f){u(!0);var p=new window.SpeechSynthesisUtterance;p.text=r,p.voice=n,p.onend=v,p.rate=a,p.pitch=d,p.volume=l,window.speechSynthesis.speak(p)}},speaking:l,cancel:function(){f&&(u(!1),window.speechSynthesis.cancel())},voices:a}}}}]);
//# sourceMappingURL=4026.44213240.chunk.js.map