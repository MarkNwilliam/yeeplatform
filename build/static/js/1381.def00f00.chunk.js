"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[1381],{41381:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var i=r(65043),n=r(85865),o=r(79650),s=r(63336),c=r(71806),a=r(84882),d=r(28076),l=r(10039),h=r(73460),u=r(11906),p=r(90035),A=r(26600),x=r(35316),j=r(98533),f=r(88861),g=r(29347),w=r(2253),y=r(30064),m=r.n(y),C=r(70579);const k=()=>{const[e,t]=(0,i.useState)([]),[r,y]=(0,i.useState)(!1),[k,v]=(0,i.useState)(""),[b,E]=(0,i.useState)([]),[S,T]=(0,i.useState)(null),[D,B]=(0,i.useState)(null),[L,z]=(0,i.useState)(""),[N,O]=(0,i.useState)(!1),[_,F]=(0,i.useState)(""),U=async()=>{const e=w.j2.currentUser;if(e)try{const r=await fetch("https://yeeplatformbackend.azurewebsites.net/getauthorchapter/".concat(e.uid));if(!r.ok){const e=await r.json();throw new Error(e.message||"An error occurred while fetching the chapters.")}const i=await r.json();t(i),v("")}catch(k){console.error("Error fetching text chapters:",k),v(k.toString()),t([])}else v("No user found in auth.")},Y=async()=>{const e=w.j2.currentUser;if(e)try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/getAudioChapters/".concat(e.uid));if(!t.ok){const e=await t.json();throw new Error(e.message||"An error occurred while fetching the audio chapters.")}const r=await t.json();E(r),v("")}catch(k){console.error("Error fetching audio chapters:",k),v(k.toString()),E([])}else v("No user found in auth.")},P=()=>{U(),Y()};(0,i.useEffect)((()=>{U(),Y()}),[]);const J=()=>{y(!1)},M=async function(r){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((async n=>{if(n.isConfirmed){m().showLoading();try{const n=i?"https://yeeplatformbackend.azurewebsites.net/deleteaudiochapter/".concat(r):"https://yeeplatformbackend.azurewebsites.net/deletechapter/".concat(r);if(!(await fetch(n,{method:"DELETE"})).ok)throw new Error("Failed to delete the chapter.");P(),i?E(b.filter((e=>e.id!==r))):t(e.filter((e=>e.id!==r))),m().hideLoading(),m().fire("Deleted!","Your file has been deleted.","success")}catch(k){m().hideLoading(),m().fire("Error!","There was an issue deleting your chapter.","error"),console.error("Error deleting chapter:",k)}}}))};return(0,C.jsxs)("div",{children:[(0,C.jsx)(n.A,{variant:"h4",component:"h2",children:"My Chapters"}),(0,C.jsx)(o.A,{component:s.A,children:(0,C.jsxs)(c.A,{children:[(0,C.jsx)(a.A,{children:(0,C.jsxs)(d.A,{children:[(0,C.jsx)(l.A,{children:"Book Title"}),(0,C.jsx)(l.A,{children:"Description"}),(0,C.jsx)(l.A,{children:"Actions"})]})}),(0,C.jsx)(h.A,{children:e.map((e=>(0,C.jsxs)(d.A,{children:[(0,C.jsx)(l.A,{children:e.title}),(0,C.jsx)(l.A,{children:e.description}),(0,C.jsxs)(l.A,{children:[(0,C.jsx)(u.A,{onClick:()=>((e,t)=>{console.log("Opening chapter for edit:",e),T(e),z(t),y(!0)})(e,e._id),children:"Edit"}),(0,C.jsx)(u.A,{onClick:()=>M(e._id),children:"Delete"})]})]},e._id)))}),0===e.length&&(0,C.jsx)(n.A,{variant:"h6",style:{textAlign:"center",padding:"20px",color:"grey"},children:"No data available."})]})}),(0,C.jsx)(n.A,{variant:"h4",component:"h2",style:{marginTop:"20px"},children:"My Audio Chapters"}),(0,C.jsxs)(o.A,{component:s.A,children:[(0,C.jsxs)(c.A,{children:[(0,C.jsx)(a.A,{children:(0,C.jsxs)(d.A,{children:[(0,C.jsx)(l.A,{children:"Book Title"}),(0,C.jsx)(l.A,{children:"Duration"}),(0,C.jsx)(l.A,{children:"Description"}),(0,C.jsx)(l.A,{children:"Audio File"}),(0,C.jsx)(l.A,{children:"Actions"})]})}),(0,C.jsx)(h.A,{children:b.map((e=>(0,C.jsxs)(d.A,{children:[(0,C.jsx)(l.A,{children:e.title}),(0,C.jsx)(l.A,{children:e.duration}),(0,C.jsx)(l.A,{children:e.description}),(0,C.jsx)(l.A,{children:(0,C.jsxs)("audio",{controls:!0,onError:e=>console.log("Error playing audio:",e),children:[(0,C.jsx)("source",{src:e.content,type:"audio/mpeg"}),"Your browser does not support the audio element."]})}),(0,C.jsxs)(l.A,{children:[(0,C.jsx)(u.A,{onClick:()=>{return t=e,r=e._id,B(t),F(r),void O(!0);var t,r},children:"Edit"}),(0,C.jsx)(u.A,{onClick:()=>M(e._id,!0),children:"Delete"})]})]},e._id)))})]}),0===b.length&&(0,C.jsx)(n.A,{variant:"h6",style:{textAlign:"center",padding:"20px",color:"grey"},children:"No audio data available."})]}),(0,C.jsxs)(p.A,{open:r,onClose:J,children:[(0,C.jsx)(A.A,{children:"Edit Chapter"}),(0,C.jsxs)(x.A,{children:[(0,C.jsx)(j.A,{children:"Please edit the chapter information."}),(0,C.jsx)(f.A,{margin:"dense",id:"description",label:"Description",type:"text",fullWidth:!0,multiline:!0,rows:10,value:(null===S||void 0===S?void 0:S.description)||"",onChange:e=>{T({...S,description:e.target.value})}})]}),(0,C.jsxs)(g.A,{children:[(0,C.jsx)(u.A,{onClick:J,children:"Cancel"}),(0,C.jsx)(u.A,{onClick:async()=>{m().fire({title:"Saving chapter...",onBeforeOpen:()=>{m().showLoading()},allowOutsideClick:()=>!m().isLoading()});try{if(!(await fetch("https://yeeplatformbackend.azurewebsites.net/updatechapter/".concat(L),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to update the chapter.");y(!1),m().fire("Success","Chapter updated successfully","success"),P()}catch(k){console.error("Error updating chapter:",k),m().fire("Error","There was a problem saving the chapter","error")}},children:"Save"})]})]}),(0,C.jsxs)(p.A,{open:N,onClose:()=>O(!1),children:[(0,C.jsx)(A.A,{children:"Edit Audio Chapter"}),(0,C.jsx)(x.A,{children:(0,C.jsx)(f.A,{margin:"dense",id:"description",label:"Description",multiline:!0,rows:4,type:"text",fullWidth:!0,value:(null===D||void 0===D?void 0:D.description)||"",onChange:e=>((e,t)=>{B({...D,[t]:e.target.value})})(e,"description")})}),(0,C.jsxs)(g.A,{children:[(0,C.jsx)(u.A,{onClick:()=>O(!1),children:"Cancel"}),(0,C.jsx)(u.A,{onClick:async()=>{m().fire({title:"Saving Audio Chapter...",didOpen:()=>{m().showLoading()}});try{const e={description:D.description},t=await fetch("https://yeeplatformbackend.azurewebsites.net/updateAudioChapter/".concat(_),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to update the audio chapter.")}O(!1),m().fire("Success!","Audio chapter updated successfully.","success"),P()}catch(k){m().fire("Error!","There was an issue saving your audio chapter: ".concat(k.message),"error"),console.error("Error updating audio chapter:",k)}},children:"Save"})]})]})]})}}}]);
//# sourceMappingURL=1381.def00f00.chunk.js.map