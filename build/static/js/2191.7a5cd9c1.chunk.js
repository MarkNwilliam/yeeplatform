"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[2191,5399],{72191:(e,t,o)=>{o.r(t),o.d(t,{default:()=>f});var a=o(65043),n=o(30064),r=o.n(n),l=o(5399),s=o(86213),i=o(85865),c=o(88861),d=o(22778),u=o(10142),h=o(63713),m=o(55440),g=o(86032),b=o(54978),x=o(70579);const p=500;const f=function(){const[e,t]=(0,a.useState)(null),[o,n]=(0,a.useState)(null),[f,v]=(0,a.useState)(""),[w,j]=(0,a.useState)(""),[y,A]=(0,a.useState)([]),[N,C]=(0,a.useState)(""),[S,k]=(0,a.useState)(""),[E,U]=(0,a.useState)(""),[P,I]=(0,a.useState)(""),[F,z]=(0,a.useState)(""),[T,B]=(0,a.useState)(""),[L,D]=(0,a.useState)("free"),[O,R]=(0,a.useState)(""),[W,H]=(0,a.useState)(!1),M=l.auth.currentUser.uid;return(0,a.useEffect)((()=>{const e=()=>{W&&H(!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[W]),(0,x.jsxs)("div",{className:"p-8 bg-white shadow-md rounded-lg max-w-md mx-auto",children:[(0,x.jsx)(i.A,{variant:"h4",className:"text-center mb-6",children:"Upload your Audiobook"}),(0,x.jsxs)("form",{onSubmit:async a=>{a.preventDefault();const l="notfree"===L;if(w.length>p)return void r().fire("Error","Description should not exceed ".concat(p," characters."),"error");if(e&&e.size>314572800)return void r().fire("Error","Audiobook file size should not exceed ".concat(300," MB."),"error");if(f.length<3||f.length>100)return void r().fire("Error","Title should be between ".concat(3," and ").concat(100," characters."),"error");if(!N)return void r().fire("Error","Please select a language.","error");const i=new Date;if(new Date(E)>i)return void r().fire("Error","Publication date cannot be in the future.","error");if(y.length<1)return void r().fire("Error","Please select at least ".concat(1," genre(s)."),"error");r().fire({title:"Uploading...",html:"Progress ....",allowEscapeKey:!1,allowOutsideClick:!1,showCancelButton:!1,showConfirmButton:!1,onBeforeOpen:()=>{r().showLoading()},onOpen:()=>{const e=r().getHtmlContainer(),t=document.createElement("div");t.setAttribute("class","sweetalert2-progress-steps"),e.appendChild(t)}});try{let a,i,c;if(o){const e=await(0,b.yh)(o,128);c=await(0,g.A)(e,!0),console.log("Here is my thumbnail url "+c)}if(e&&(a=await(0,g.A)(e)),o&&(console.log("Uploading coverFile: ",o),i=await(0,g.A)(o),console.log("This is my coverurl "+i)),w.length>p)return void r().fire("Error","Description should not exceed ".concat(p," characters."),"error");if(!a||!i)throw new Error("Please select both audio and cover files.");const d={title:f,description:w,genres:y.join(", "),categories:y.join(", "),language:N,isbn:S,ebookUrl:a,coverUrl:i,thumbnailUrl:c,publicationDate:E,author_platform_id:M,Duration:T,monetization:l,audioUrl:a},u=await s.A.post("https://yeeplatformbackend.azurewebsites.net/audiobookupload/".concat(M),d);if(r().close(),200!==u.status)throw new Error("Error while sending data to the server.");t(null),n(null),v(""),j(""),A([]),C(""),k(""),B(""),U(""),I(""),z(""),D("free"),R(""),H(!0)}catch(c){r().fire("Error","Error uploading the audio. Please try again.","error"),console.error("Error uploading the audio:",c)}},encType:"multipart/form-data",children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Title:"}),(0,x.jsx)(c.A,{fullWidth:!0,variant:"outlined",value:f,onChange:e=>v(e.target.value),required:!0})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Description:"}),(0,x.jsx)(c.A,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:w,onChange:e=>j(e.target.value),required:!0,helperText:"".concat(w.length,"/").concat(p)})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)(m.A,{label:"Upload Cover Image:",onChange:async e=>{const t=e.target.files[0];if(console.log("Handle Cover Change Function Called"),t){if(!(e=>e.size/1024/1024<=5)(t)){try{r().fire({icon:"error",title:"Error",text:"Image size should not exceed 5MB."}).then((()=>{n(null),I(""),R("")}))}catch(o){console.log(o)}return}const e=await(e=>new Promise((t=>{const o=new Image;o.onload=()=>{t(512===o.width&&800===o.height)},o.src=URL.createObjectURL(e)})))(t);if(!e){try{r().fire({icon:"error",title:"Error",text:"Image dimensions should be exactly 512x800 pixels.",timer:3e3}).then((()=>{n(null),I(""),R("")}))}catch(o){console.log(o)}return}n(t),I(t.name),R(URL.createObjectURL(t)),console.log("Function Execution Completed")}},fileName:P,accept:".jpg, .jpeg, .png",required:!0}),O&&(0,x.jsx)("div",{className:"image-preview",children:(0,x.jsx)("img",{src:O,alt:"Cover Preview",style:{maxWidth:"200px",maxHeight:"200px"}})})]}),(0,x.jsx)("div",{className:"mb-4",children:(0,x.jsx)(d.A,{multiple:!0,options:["Fiction","Nonfiction","Science Fiction","Romance","Mystery/Thriller","Fantasy","Biography","History","Business/Economics","Self-help","Health/Fitness","Cooking/Food","Travel","Technology"],value:y,onChange:(e,t)=>A(t),renderInput:e=>(0,x.jsx)(c.A,{...e,variant:"outlined",label:"Genres"})})}),(0,x.jsx)("div",{className:"mb-4",children:(0,x.jsx)(d.A,{options:[{code:"eng",label:"English"},{code:"French",label:"French"},{code:"swahili",label:"Swahili"},{code:"amharic",label:"Amharic"},{code:"yoruba",label:"Yoruba"},{code:"oromo",label:"Oromo"},{code:"igbo",label:"Igbo"},{code:"zulu",label:"Zulu"},{code:"shona",label:"Shona"},{code:"xhosa",label:"Xhosa"},{code:"hausa",label:"Hausa"},{code:"fulani",label:"Fulani"}].map((e=>e.label)),value:N,onChange:(e,t)=>C(t),renderInput:e=>(0,x.jsx)(c.A,{...e,variant:"outlined",label:"Language"})})}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"ISBN:"}),(0,x.jsx)(c.A,{fullWidth:!0,variant:"outlined",value:S,onChange:e=>k(e.target.value)})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Monetization:"}),(0,x.jsxs)("select",{value:L,onChange:e=>D(e.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[(0,x.jsx)("option",{value:"free",children:"Free"}),(0,x.jsx)("option",{value:"notfree",children:"Not Free"})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Publication Date:"}),(0,x.jsx)(c.A,{type:"date",fullWidth:!0,variant:"outlined",value:E,onChange:e=>U(e.target.value),required:!0})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsx)(m.A,{label:"Upload Audio File:",onChange:e=>{var o;t(e.target.files[0]),z((null===(o=e.target.files[0])||void 0===o?void 0:o.name)||""),(e=>{const t=URL.createObjectURL(e);let o=new Audio(t);o.onloadedmetadata=()=>{B(Math.floor(o.duration)),URL.revokeObjectURL(t)}})(e.target.files[0])},fileName:F,accept:".mp3, .wav",required:!0}),(0,x.jsxs)("div",{className:"text-sm text-gray-600",children:["Maximum file size: ",300," MB"]})]}),(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)(h.A,{buttonText:"Upload"})})]}),W&&(0,x.jsx)(u.A,{isOpen:W,onClose:()=>{console.log("Closing success dialog"),H(!1)},points:100,message:"Well done! You're a real YeePlatform author."})]})}},5399:(e,t,o)=>{o.d(t,{$s:()=>n.$s,Cg:()=>d,GoogleAuthProvider:()=>r.HF,auth:()=>i,onAuthStateChanged:()=>r.hg,signInWithEmailAndPassword:()=>r.x9,signInWithPopup:()=>r.df,signOut:()=>r.CI,zS:()=>c});var a=o(37064),n=o(82413),r=o(32813);const l={apiKey:"AIzaSyBXS56tIro9cd-Sd4ySn5AwLw3T6cnMHr0",authDomain:"yeeplatform.firebaseapp.com",projectId:"yeeplatform",storageBucket:"yeeplatform.appspot.com",messagingSenderId:"272587831821",appId:"1:272587831821:web:b612b427ff43968f33f344",measurementId:"G-YZV03469PP"};let s,i,c;(async()=>{if(!s){s=(0,a.Wp)(l),i=(0,r.xI)(s);await(0,n.TT)()&&(c=(0,n.P5)(s))}})();const d=(e,t)=>{c&&(0,n.$s)(c,e,t)}},86032:(e,t,o)=>{o.d(t,{A:()=>a});const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=await fetch("https://yeeplatformbackend.azurewebsites.net/generateSasToken"),a=(await o.json()).sasToken;let n=t?"thumbnail-".concat(Date.now(),".jpg"):e.name;const r="https://yeeplatform.blob.core.windows.net/yeeebooks/".concat(n,"?").concat(a),l={method:"PUT",body:e,headers:{"x-ms-blob-type":"BlockBlob"}};if((await fetch(r,l)).ok){return r.split("?")[0]}throw new Error("Error uploading to Azure Blob Storage")}},54978:(e,t,o)=>{o.d(t,{S1:()=>l,yh:()=>r});var a=o(55861);const n=o.n(a)()(),r=(e,t)=>new Promise(((o,a)=>{const r=new FileReader;r.onload=e=>{const r=new Image;r.onload=()=>{const e=t/r.width,l=r.height*e,s=document.createElement("canvas");s.width=t,s.height=l,n.resize(r,s).then((e=>n.toBlob(e,"image/jpeg",.8))).then((e=>o(e))).catch((e=>a(e)))},r.src=e.target.result},r.onerror=a,r.readAsDataURL(e)})),l=(e,t,o)=>{const a=e.size/1048576;return a>=t&&a<=o}},63713:(e,t,o)=>{o.d(t,{A:()=>n});o(65043);var a=o(70579);const n=function(e){let{buttonText:t}=e;return(0,a.jsx)("button",{type:"submit",className:"bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:shadow-outline",children:t})}},10142:(e,t,o)=>{o.d(t,{A:()=>u});var a=o(65043),n=o(90035),r=o(29347),l=o(35316),s=o(26600),i=o(11906),c=o(12707),d=o(70579);const u=function(e){let{isOpen:t,onClose:u,points:h,message:m}=e;const g=a.lazy((()=>Promise.resolve().then(o.t.bind(o,93750,23))));return(0,d.jsxs)(n.A,{open:t,onClose:u,children:[(0,d.jsx)(s.A,{className:"text-center",children:"Success!"}),(0,d.jsxs)(l.A,{className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)(a.Suspense,{fallback:(0,d.jsx)("div",{children:"Loading..."}),children:(0,d.jsx)(g,{animationData:c,style:{width:"auto",maxWidth:"100%",height:200}})}),(0,d.jsx)("p",{children:m}),(0,d.jsxs)("div",{className:"text-center animate-pulse",children:[(0,d.jsx)("p",{className:"text-yellow-500 font-bold text-xl",children:"You've got"}),(0,d.jsxs)("span",{className:"text-4xl text-yellow-500",children:[h," Points!"]})]}),(0,d.jsx)("p",{children:"Your content will be available in the marketplace soon."})]}),(0,d.jsx)(r.A,{children:(0,d.jsx)(i.A,{onClick:u,color:"primary",children:"Close"})})]})}},55440:(e,t,o)=>{o.d(t,{A:()=>r});o(65043);var a=o(62954),n=o(70579);const r=function(e){let{label:t,onChange:o,fileName:r,accept:l,required:s}=e;return(0,n.jsxs)("div",{children:[t&&(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:t}),(0,n.jsxs)("label",{className:"w-full flex items-center px-4 py-2 rounded-lg shadow-lg tracking-wide uppercase border cursor-pointer hover:bg-yellow-500 hover:text-white ".concat(r?"bg-yellow-500 text-white":"bg-white text-yellow-500 border-yellow-500"),children:[(0,n.jsx)(a.A,{className:"mr-2"}),r||"Choose File",(0,n.jsx)("input",{type:"file",onChange:o,className:"hidden",accept:l,required:s})]})]})}}}]);
//# sourceMappingURL=2191.7a5cd9c1.chunk.js.map