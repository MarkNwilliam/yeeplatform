"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[1638,5016],{90594:(e,t,s)=>{s.d(t,{A:()=>h});var a=s(65043),o=s(26600),r=s(90035),n=s(88861),c=s(11906),l=s(96446),i=s(28883),d=s(81637),u=s(12220),m=s(70579);const h=function(e){const{onClose:t,open:s,type:h,_id:p,userEmail:g,setSnackbarMessage:f}=e,[x,b]=a.useState(""),[y,j]=a.useState(5),[w,v]=(0,a.useState)(null),[k,N]=(0,a.useState)(!1),[A,S]=(0,a.useState)(!1),C=()=>{k||(f("Working on it..."),t())};return(0,a.useEffect)((()=>{(async()=>{try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/reviews/user/".concat(g,"/").concat(h,"/").concat(p,"/reviews"));if(!e.ok)throw new Error("HTTP error! status: ".concat(e.status));const t=await e.json();t&&t.length>0&&v(t[0])}catch(e){}})()}),[]),(0,a.useEffect)((()=>{w&&(b(w.comment),j(w.rating))}),[w]),(0,m.jsxs)(r.A,{onClose:C,open:s,children:[(0,m.jsx)(o.A,{children:"Add a Review"}),(0,m.jsxs)(l.A,{p:1,children:[(0,m.jsx)(i.A,{name:"simple-controlled",value:y,onChange:(e,t)=>{j(t)}}),(0,m.jsx)(n.A,{autoFocus:!0,margin:"dense",id:"review",label:"Your Review",type:"text",fullWidth:!0,value:x,onChange:e=>{b(e.target.value)}}),(0,m.jsx)(c.A,{onClick:()=>{w?(async()=>{N(!0),f("Updating review...");const e=await fetch("https://yeeplatformbackend.azurewebsites.net/reviews/user/".concat(g,"/").concat(h,"/").concat(p,"/review/").concat(w._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:y,comment:x})});await e.json(),e.ok?(f("Review updated successfully"),S(!0),N(!1)):(f("Failed to update review"),S(!0),N(!1)),S(!0),N(!1)})():(async()=>{N(!0),f("Posting review...");try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/reviews/".concat(h),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audiobookId:p,userEmail:g,rating:y,comment:x})}),t=await e.json();"User has already reviewed this audiobook"===t.message?(f(t.message),S(!0),N(!1)):f("Review posted successfully"),S(!0)}catch(e){f("Failed to post review"),S(!0),N(!1)}N(!1)})(),C()},color:"primary",children:"Submit"}),(0,m.jsx)(c.A,{onClick:async()=>{f("Deleting review..."),N(!0);try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/reviews/user/".concat(g,"/").concat(h,"/").concat(p,"/review/").concat(w._id),{method:"DELETE"});await e.json();e.ok?(f("Review deleted successfully"),S(!0),C(),N(!1)):(f("Failed to delete review"),S(!0),N(!1)),S(!0)}catch(e){f("Failed to delete review"),S(!0)}N(!1)},color:"secondary",children:"Delete Review"})]}),(0,m.jsx)(u.A,{open:k,children:(0,m.jsx)(d.A,{color:"inherit"})})]})}},14878:(e,t,s)=>{s.d(t,{A:()=>u});s(65043);var a=s(73216),o=s(35801),r=s(85883),n=s(43867),c=s(50419),l=s(52907),i=s(68016),d=s(70579);const u=e=>{let{open:t,onClose:s}=e;const u=(0,a.Zp)();return(0,d.jsxs)(o.A,{open:t,onClose:s,children:[(0,d.jsx)(r.A,{children:"Login Required"}),(0,d.jsx)(n.A,{children:(0,d.jsx)(c.A,{children:"Please log in to add a review."})}),(0,d.jsxs)(l.A,{children:[(0,d.jsx)(i.A,{onClick:s,color:"primary",children:"Close"}),(0,d.jsx)(i.A,{onClick:()=>{u("/login")},color:"primary",variant:"outlined",children:"Log In"})]})]})}},35016:(e,t,s)=>{s.r(t),s.d(t,{AuthContext:()=>c,AuthProvider:()=>i,default:()=>d,useAuth:()=>l});var a=s(65043),o=s(5399),r=s(53536),n=s(70579);const c=(0,a.createContext)();function l(){return a.useContext(c)}function i(e){let{children:t}=e;const[s,l]=(0,a.useState)(!1),[i,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[h,p]=(0,a.useState)((()=>JSON.parse(localStorage.getItem("isVerified"))||!1)),g=(0,a.useCallback)((0,r.debounce)((async e=>{if(e&&e.uid)try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/isAuthor/".concat(e.uid));if(t.ok){const e=await t.json();l(e.isAuthor)}}catch(t){}}),15e3),[]),f=(0,a.useCallback)((async(e,t)=>{try{var s;const a=await(0,o.x9)(o.j2,e,t);d(a.user);const r=(null===(s=a.user)||void 0===s?void 0:s.emailVerified)||!1;p(r),localStorage.setItem("isVerified",r.toString())}catch(a){}}),[]),x=(0,a.useCallback)((async()=>{const e=new o.HF;try{var t;const s=await(0,o.df)(o.j2,e);d(s.user);const a=(null===(t=s.user)||void 0===t?void 0:t.emailVerified)||!1;p(a),localStorage.setItem("isVerified",a.toString())}catch(s){}}),[]),b=(0,a.useCallback)((async()=>{try{await(0,o.CI)(o.j2),d(null),l(!1)}catch(e){}}),[]);(0,a.useEffect)((()=>{const e=(0,o.hg)(o.j2,(async e=>{d(e),m(!1),e&&(p(e.emailVerified),localStorage.setItem("isVerified",e.emailVerified.toString()))}));return()=>e()}),[]),(0,a.useEffect)((()=>{i&&g(i)}),[i,g]);const y={user:i,isAuthor:s,loading:u,isVerified:h,login:f,logout:b,loginWithGoogle:x};return(0,n.jsx)(c.Provider,{value:y,children:t})}const d=i},5399:(e,t,s)=>{s.d(t,{$s:()=>o.$s,CI:()=>r.CI,Cg:()=>i,HF:()=>r.HF,df:()=>r.df,hg:()=>r.hg,j2:()=>l,x9:()=>r.x9,zS:()=>c});var a=s(37064),o=s(82413),r=s(32813);const n=(0,a.Wp)({apiKey:"AIzaSyBXS56tIro9cd-Sd4ySn5AwLw3T6cnMHr0",authDomain:"yeeplatform.firebaseapp.com",projectId:"yeeplatform",storageBucket:"yeeplatform.appspot.com",messagingSenderId:"272587831821",appId:"1:272587831821:web:b612b427ff43968f33f344",measurementId:"G-YZV03469PP"});let c;(0,o.TT)().then((e=>{e&&(c=(0,o.P5)(n))}));const l=(0,r.xI)(n),i=(e,t)=>{c?(0,o.$s)(c,e,t):console.warn("Firebase Analytics is not initialized yet.")}},47058:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(65043),o=s(73216),r=s(28883),n=s(29402),c=s(5399),l=s(41591),i=s(10611),d=s(63336),u=s(59135),m=s(90594),h=s(35016),p=s(14878),g=s(18729),f=s(17392),x=s(74802),b=s(11906),y=s(70579);const j=()=>{const{id:e}=(0,o.g)(),t=(0,o.Zp)(),[s,j]=(0,a.useState)(null),[w,v]=(0,a.useState)(!0),[k,N]=(0,a.useState)(null),[A,S]=(0,a.useState)([]),[C,I]=(0,a.useState)(2),[_,z]=(0,a.useState)(1),[L,E]=(0,a.useState)(1),[P,F]=(0,a.useState)([]),[T,D]=(0,a.useState)(!1),[V,R]=(0,a.useState)(!1),{user:O}=(0,h.useAuth)(),[Y,B]=a.useState(!1),[H,M]=(0,a.useState)(""),W="https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",$=(0,a.useCallback)((async()=>{try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/reviews/audiobook/".concat(e,"/reviews?page=").concat(_,"&limit=2")),s=await t.json();F(s)}catch(t){N(t.message)}}),[e,_]),U=(0,a.useCallback)((async t=>{try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/getallaudiobooks?page=3&limit=10"),s=await t.json();S(s.data.filter((t=>t._id!==e)))}catch(s){N(s.message)}}),[e,L]);(0,a.useEffect)((()=>{H&&B(!0),(async()=>{try{const t=await fetch("https://yeeplatformbackend.azurewebsites.net/getAudiobook/".concat(e)),[s]=await Promise.all([t]).then((e=>Promise.all(e.map((e=>e.json())))));j(s),$(),U(s.categories),(0,c.$s)("audiobook_detail_fetched",{audiobookId:e})}catch(t){N(t.message)}finally{v(!1)}})()}),[e,$,U,H]);const J=()=>{t("/audiobooklisten/".concat(e,"/listen")),(0,c.$s)(c.zS,"audiobook_detail_listen_clicked",{audiobookId:e})};if(w)return(0,y.jsx)(i.A,{className:"text-yellow-500 flex justify-center items-center h-screen"});const Z=e=>{D(!1),B(!0),$()},G=(e,t)=>{"clickaway"!==t&&B(!1)},q=(0,y.jsxs)(a.Fragment,{children:[(0,y.jsx)(b.A,{color:"secondary",size:"small",onClick:Z,children:"CLOSE"}),(0,y.jsx)(f.A,{size:"small","aria-label":"close",color:"inherit",onClick:G,children:(0,y.jsx)(x.A,{fontSize:"small"})})]});return(0,y.jsxs)("div",{className:"container mx-auto p-4",children:[(0,y.jsxs)(l.m,{children:[(0,y.jsxs)("title",{children:[s.title," - Yee FM"]}),(0,y.jsx)("meta",{name:"description",content:s.description}),(0,y.jsx)("meta",{name:"keywords",content:s.keywords||s.genre||s.categories||"audiobook, Yee FM, reading, literature"}),(0,y.jsx)("link",{rel:"icon",href:s.coverImage||"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp"}),(0,y.jsx)("meta",{property:"og:title",content:"".concat(s.title," - Yee FM")}),(0,y.jsx)("meta",{property:"og:description",content:s.description}),(0,y.jsx)("meta",{property:"og:image",content:s.coverImage||"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp"}),(0,y.jsx)("meta",{property:"og:type",content:"audiobook"}),(0,y.jsx)("meta",{property:"og:url",content:window.location.href}),(0,y.jsx)("meta",{property:"og:audio",content:s.audioUrl}),(0,y.jsx)("meta",{property:"og:audio:type",content:"audio/mpeg"})]}),(0,y.jsx)("button",{onClick:()=>{t("/audiobooks"),(0,c.$s)(c.zS,"audiobook_detail_back_clicked",{audiobookId:e})},className:"mb-4 text-blue-600 hover:text-blue-800",children:"\u2190 Back"}),(0,y.jsxs)("div",{className:"flex flex-col lg:flex-row items-center lg:items-start bg-white rounded-lg shadow",children:[(0,y.jsx)("div",{className:"w-full lg:w-1/4 p-4",children:(0,y.jsx)("img",{src:s.coverImage&&s.coverImage.endsWith("undefined")?W:s.coverImage||W,alt:s.title,onClick:J,className:"rounded-lg shadow-xl mx-auto",style:{maxWidth:"100%",height:"auto"}})}),(0,y.jsxs)("div",{className:"w-full lg:w-3/4 lg:ml-6",children:[(0,y.jsx)("h1",{className:"text-3xl font-bold mb-2 text-center lg:text-left",children:s.title||"N/A"}),(0,y.jsxs)("p",{className:"text-sm text-gray-600 text-center lg:text-left mb-4",children:["Published on: ",new Date(s.publishedDate||"N/A").toLocaleDateString()]}),(0,y.jsx)(r.A,{name:"read-only",value:s.ratings||0,readOnly:!0})," ",(0,y.jsxs)("div",{className:"mt-4",children:[(0,y.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Description"}),(0,y.jsx)("p",{className:"text-gray-700",children:s.description||"N/A"})]}),(0,y.jsxs)("div",{className:"mt-6",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold",children:"Details"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex items-center text-center",children:[(0,y.jsx)("span",{className:"font-semibold mr-2",children:"Author:"}),(0,y.jsx)("span",{children:s.author||"N/A"})]}),(0,y.jsxs)("div",{className:"flex items-center text-center",children:[(0,y.jsx)("span",{className:"font-semibold mr-2",children:"ISBN:"}),(0,y.jsx)("span",{children:s.ISBN||"N/A"})]}),(0,y.jsxs)("div",{className:"flex items-center text-center",children:[(0,y.jsx)("span",{className:"font-semibold mr-2",children:"Categories:"}),(0,y.jsx)("span",{children:s.categories?s.categories.join(", "):"N/A"})]})]})]}),(0,y.jsx)("button",{onClick:J,className:"mb-4 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded",children:"Listen"}),(0,y.jsxs)("div",{className:"mt-6 relative p-4",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold",children:"Reviews"}),(0,y.jsx)("button",{className:"text-blue-500 px-4 py-2 rounded absolute top-0 right-0",onClick:()=>{O?D(!0):R(!0)},children:"Add Review"}),O&&(0,y.jsx)(m.A,{open:T,onClose:Z,type:"audiobook",userEmail:O.email,_id:e,setSnackbarMessage:M}),(0,y.jsx)(p.A,{open:V,onClose:()=>{R(!1)}}),P.reviews&&P.reviews.length>0?P.reviews.slice(0,C).map(((e,t)=>(0,y.jsxs)(d.A,{elevation:3,className:"mt-4 p-4 border border-gray-200 rounded-lg relative",children:[(0,y.jsx)(r.A,{name:"read-only",value:e.rating||0,readOnly:!0}),(0,y.jsx)("p",{className:"text-gray-800",children:e.comment}),(0,y.jsx)("p",{className:"text-blue-500 absolute top-2 right-2 text-sm",children:new Date(e.createdAt).toLocaleDateString()})]},t))):(0,y.jsx)("p",{children:"No reviews yet."}),(0,y.jsx)("div",{className:"flex justify-center p-4",children:(0,y.jsx)(u.A,{count:P.totalPages,page:_,onChange:(e,t)=>{z(t)},variant:"outlined",color:"primary"})})]})]})]}),(0,y.jsxs)("div",{className:"mt-8",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold",children:"Listen"}),(0,y.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.length>0?A.map(((e,t)=>(0,y.jsx)(n.A,{title:e.title,coverImage:e.coverImage,itemType:e.type,itemId:e._id,rating:e.rating},t))):(0,y.jsx)("p",{children:"No related content found."})}),(0,y.jsx)("div",{className:"flex justify-center p-4",children:(0,y.jsx)(u.A,{count:10,page:L,onChange:(e,t)=>{E(t)},variant:"outlined",color:"primary"})})]}),(0,y.jsx)(g.A,{open:Y,autoHideDuration:2e3,onClose:G,message:H,action:q})]})}},29402:(e,t,s)=>{s.d(t,{A:()=>c});s(65043);var a=s(35475),o=s(28883),r=s(9634),n=(s(73812),s(70579));const c=function(e){let{title:t,coverImage:s,itemType:c,itemId:l,rating:i}=e;const d="https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",u=e=>{e.target.src=d};return(0,n.jsxs)("div",{className:"rounded overflow-hidden shadow-lg bg-white w-full",children:[(0,n.jsx)("div",{className:"aspect-w-16 aspect-h-25 overflow-hidden",children:(()=>{switch(c){case"audiobook":return(0,n.jsx)("a",{href:"/audiobooks/".concat(l),children:(0,n.jsx)(r.LazyLoadImage,{className:"object-cover w-full h-full",src:s||d||"https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",alt:t,loading:"lazy",effect:"blur",onError:u})});case"audiochapter":return(0,n.jsx)("a",{href:"/audiochapters/".concat(l),children:(0,n.jsx)(r.LazyLoadImage,{className:"object-cover w-full h-full",src:s||d||"https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",alt:t,loading:"lazy",effect:"blur",onError:u})});case"Text":case"notes":case"chapters":return(0,n.jsx)(a.N_,{to:"/chapters/".concat(l),children:(0,n.jsx)(r.LazyLoadImage,{className:"object-cover w-full h-full",src:s||d||"https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",alt:t,loading:"lazy",effect:"blur",onError:u})});case"ebook":return(0,n.jsx)(a.N_,{to:"/ebooks/".concat(l),children:(0,n.jsx)(r.LazyLoadImage,{className:"object-cover w-full h-full",src:s||d||"https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",alt:t,loading:"lazy",effect:"blur",onError:u})});default:return(0,n.jsx)(r.LazyLoadImage,{className:"object-cover w-full h-full",src:s||d||"https://yeeplatformstorage.blob.core.windows.net/assets/images/yeeplatform_book_cover.png",alt:t,loading:"lazy",effect:"blur",onError:u})}})()}),(0,n.jsxs)("div",{className:"px-3 py-1",children:[(0,n.jsx)("div",{className:"font-bold text-md mb-1 line-clamp-2",children:t}),(0,n.jsx)(o.A,{name:"read-only",value:i,readOnly:!0,size:"small"})]}),(0,n.jsx)("div",{className:"px-3 pb-1 flex justify-center",children:(()=>{const e="bg-transparent text-yellow-500 font-bold py-2 px-4 rounded border border-yellow-500 focus:outline-none focus:border-none focus:ring ring-transparent no-underline transition-all duration-300 hover:bg-yellow-500 hover:text-red hover:border-yellow-500 hover:scale-105";switch(c){case"audiobook":return(0,n.jsx)("a",{href:"/audiobooks/".concat(l),className:e,children:"Listen"});case"audiochapter":return(0,n.jsx)("a",{href:"/audiochapters/".concat(l),className:e,children:"Listen"});case"Text":case"Chapters":case"chapter":case"chapters":case"Chapter":return(0,n.jsx)(a.N_,{to:"/chapters/".concat(l),className:e,children:"Chapter"});case"notes":case"PDF":return(0,n.jsx)(a.N_,{to:"/notespdf/".concat(l),className:e,children:"read"});case"ebook":return(0,n.jsx)(a.N_,{to:"/ebooks/".concat(l),className:"no-underline ".concat(e),children:"Book"});default:return null}})()})]})}}}]);
//# sourceMappingURL=1638.d6567e64.chunk.js.map