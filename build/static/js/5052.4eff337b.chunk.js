"use strict";(self.webpackChunkyeeplatform=self.webpackChunkyeeplatform||[]).push([[5052],{46681:(e,o,t)=>{t.d(o,{A:()=>i});var a=t(65043),n=t(71935),r=(t(88331),t(70579));const i=e=>{let{handleNewUserMessage:o}=e;const[t,i]=(0,a.useState)(!0);return(0,r.jsx)(n.Widget,{handleNewUserMessage:o,title:"Ebook Chatbot",subtitle:"Ask me anything about this ebook",profileAvatar:"https://assets-hfbubwfaacbch3e0.z02.azurefd.net/assets/images/Y.webp",emojis:"true",handleToggle:e=>{i((e=>!e))}})}},84847:(e,o,t)=>{t.r(o),t.d(o,{default:()=>A});var a=t(65043),n=t(50527);const r="#ffde5a";var i=t(73216),s=t(98225),l=t(85369),c=t(11906),u=t(88861),d=t(67254),g=t(46681),f=t(86213),p=t(81929),h=t.n(p),m=t(30064),b=t.n(m),v=t(1043),y=t.n(v),x=t(71935),k=t(70579);function S(e,o,t){const a=e.themes;switch(o){case"dark":a.override("color","#fff"),a.override("background-color","#000"),a.override("font-family",t);break;case"light":a.override("color","#000"),a.override("background","#fff"),a.override("font-family",t)}}const w={...n.Ko,readerArea:{...n.Ko.readerArea,transition:void 0},arrow:{...n.Ko.arrow,color:r},arrowHover:{...n.Ko.arrowHover,color:r},titleArea:{...n.Ko.titleArea,color:"black"},tocArea:{...n.Ko.tocArea,color:r},tocButtonExpanded:{...n.Ko.tocButtonExpanded,color:r},tocButtonBar:{...n.Ko.tocButtonBar,background:"black"},tocButton:{...n.Ko.tocButton,color:r}},C={...n.Ko,arrow:{...n.Ko.arrow,color:"white"},arrowHover:{...n.Ko.arrowHover,color:"yellow"},readerArea:{...n.Ko.readerArea,backgroundColor:"#000",transition:void 0},titleArea:{...n.Ko.titleArea,color:"#ccc"},tocArea:{...n.Ko.tocArea,background:"#111"},tocButtonExpanded:{...n.Ko.tocButtonExpanded,background:"#222"},tocButtonBar:{...n.Ko.tocButtonBar,background:"#fff"},tocButton:{...n.Ko.tocButton,color:"white"}},A=()=>{var e;const[o,t]=(0,a.useState)(""),[p,m]=(0,a.useState)("light"),v=(0,i.Zp)(),A=(0,a.useRef)(void 0),{id:j}=(0,i.g)(),[B,L]=(0,a.useState)(null),[T,R]=(0,a.useState)(localStorage.getItem("font")||"Georgia, serif"),[G,K]=(0,a.useState)(""),[E,M]=(0,a.useState)(null),[I,_]=(0,a.useState)(""),[z,N]=(0,a.useState)([]),[P,U]=(0,a.useState)(0),[H,O]=(0,a.useState)(!1),[F,V]=(0,a.useState)(null),[q,D]=(0,a.useState)(null),W=(0,a.useRef)(null),Q=(0,a.useRef)(null),[Z,$]=(0,a.useState)([]),J=null===(e=s.j2.currentUser)||void 0===e?void 0:e.email;function X(e){const o=e.start.cfi.split("/"),a=o[0]+"/"+o[1]+"/"+o[2]+"/"+o[3],n=[a,e.start.cfi.replace(a,""),e.end.cfi.replace(a,"")].join(","),r=W.current.getRange(n).toString();t(r)}function Y(e,o){const t=W.current.getRange(e).toString();$(Z.concat({text:t,cfiRange:e})),W.current.annotations.add("highlight",e,{},null,"hl",{fill:"red","fill-opacity":"0.5","mix-blend-mode":"multiply"}),o.window.getSelection().removeAllRanges()}(0,a.useEffect)((()=>{if(W.current)return W.current.on("selected",Y),W.current.on("relocated",X),()=>{W.current.off("selected",Y)}}),[$,Z]),(0,a.useEffect)((()=>{localStorage.setItem("font",T),A.current&&A.current.themes.override("font-family",T)}),[T]),(0,a.useEffect)((()=>{A.current&&S(A.current,p,T)}),[T]),(0,a.useEffect)((()=>{(async()=>{setIsLoading(!0);try{const e=await fetch("https://yeeplatformbackend.azurewebsites.net/getEbook/".concat(j)),o=await e.json();L(o)}catch(e){console.error("Error fetching eBook content:",e.message)}finally{setIsLoading(!1),(0,s.$s)(s.zS,(null===B||void 0===B?void 0:B.title)+"_reader_page_visited")}})()}),[j]),(0,a.useEffect)((()=>{A.current&&S(A.current,p)}),[p]);const[ee,oe]=(0,a.useState)(null),te={backgroundColor:r,color:"black",borderRadius:"50%",padding:"10px",fontSize:"20px",position:"absolute",top:"10px",left:"10px"},ae={backgroundColor:r,color:"black",borderRadius:"50%",padding:"10px",fontSize:"20px",margin:"10px"};return(0,a.useEffect)((()=>{(e=>{if(W.current&&Q.current){const{displayed:e,href:o}=W.current.location.start,t=Q.current.find((e=>e.href===o));K("Page ".concat(e.page," of ").concat(e.total," in chapter ").concat(t?t.label:"n/a"))}})()}),[ee]),(0,k.jsxs)("div",{style:{height:"100vh"},children:[(0,k.jsxs)("button",{style:te,onClick:()=>v("/ebooks/".concat(j)),children:[(0,k.jsx)(l.QVr,{})," "]}),(0,k.jsxs)("button",{style:ae,onClick:()=>m("light"),children:[(0,k.jsx)(l.wQq,{})," "]}),(0,k.jsxs)("button",{style:ae,onClick:()=>m("dark"),children:[(0,k.jsx)(l.V6H,{})," "]}),(0,k.jsxs)("button",{style:ae,onClick:async()=>{D(null);const{value:e}=await b().fire({title:"Select language",html:'\n      <form id="languageForm" style="display: flex; flex-direction: column; align-items: start;">\n          <label><input type="radio" name="language" value="eng"> English</label><br>\n          <label><input type="radio" name="language" value="swh"> Swahili</label><br>\n          <label><input type="radio" name="language" value="spa"> Spanish</label><br>\n          <label><input type="radio" name="language" value="arz"> Arabic</label><br>\n          <label><input type="radio" name="language" value="fra"> French</label><br>\n          \n        </form>\n      ',focusConfirm:!1,preConfirm:()=>{const e=document.getElementById("languageForm").elements.language;let o;for(let t=0;t<e.length;t++)if(e[t].checked){o=e[t].value;break}return o}});if(e){b().fire({title:"Loading...",allowOutsideClick:!1,onBeforeOpen:()=>{b().showLoading()}});let a=B.title.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"");try{const t=(await f.A.post("https://yeeplatform.com/server/synthesize",{text:o,book_title:a,page_number:G,language:e},{timeout:6e6})).data.audio_url;D("https://yeeplatform.com/server/"+t),b().close()}catch(t){b().fire({icon:"error",title:"Oops...",text:"Something went wrong!",footer:"<a href>Why do I have this issue?</a>"}),console.error("Error playing audio:",t)}}},children:[(0,k.jsx)(l.gSK,{})," "]}),(0,k.jsx)("select",{value:T,onChange:e=>R(e.target.value),children:["Georgia, serif","Arial, sans-serif","Courier New, monospace","Times New Roman, Times, serif","Verdana, Geneva, sans-serif","Tahoma, Geneva, sans-serif","Trebuchet MS, Helvetica, sans-serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Lucida Sans Unicode","Lucida Grande, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Garamond, serif","Bookman Old Style, serif","Arial Black, Gadget, sans-serif","Comic Sans MS, cursive, sans-serif","Impact, Charcoal, sans-serif","Gill Sans, sans-serif","Franklin Gothic Medium, Arial, sans-serif","Consolas, monaco, monospace","Courier, monospace","Lucida Console, Monaco, monospace","Lucida Sans Typewriter, Lucida Console, monaco, Bitstream Vera Sans Mono, monospace","American Typewriter, Georgia, serif","Andale Mono, AndaleMono, monospace","Futura, Century Gothic, AppleGothic, sans-serif","Gill Sans, Calibri, Trebuchet MS, sans-serif","Helvetica, Arial, sans-serif","Impact, Haettenschweiler, Franklin Gothic Bold, Charcoal, Helvetica Inserat, sans-serif","Lucida Grande, Lucida Sans, Lucida Sans Unicode, sans-serif","Monaco, Consolas, Lucida Console, monospace","Optima, Segoe, Candara, Calibri, Arial, sans-serif","Palatino, Palatino Linotype, Palatino LT STD, Book Antiqua, Georgia, serif","Tahoma, Verdana, Segoe, sans-serif","TimesNewRoman, Times New Roman, Times, Baskerville, Georgia, serif","Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif","Roboto, sans-serif","Montserrat, sans-serif"].map((e=>(0,k.jsx)("option",{value:e,children:e},e)))}),(0,k.jsx)(u.A,{id:"outlined-basic",label:"Search",variant:"outlined",type:"text",value:I,onChange:e=>{_(e.target.value)},style:{marginTop:"1%",marginRight:"1%"}}),(0,k.jsx)(c.A,{onClick:async()=>{if(A.current&&I){O(!0),V(null);try{const o=await(e=I,Promise.all(A.current.book.spine.spineItems.map((o=>o.load(A.current.book.load.bind(A.current.book)).then(o.find.bind(o,e)).finally(o.unload.bind(o))))).then((e=>(A.current.annotations.remove(),e.forEach((e=>{A.current.annotations.highlight(e.cfi,{},(e=>{}))})),Promise.resolve([].concat.apply([],e))))));N(o)}catch(o){V(o.message)}finally{O(!1)}}var e},variant:"outlined",style:{marginTop:"20px",padding:"10px"},children:"Search"}),(0,k.jsx)("div",{children:H?(0,k.jsx)("p",{children:"Searching..."}):F?(0,k.jsx)(d.A,{severity:"error",children:"Text not found please search for something else."}):z.length>0?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(c.A,{style:{marginRight:"1%"},onClick:()=>{const e=(P-1+z.length)%z.length,o=z[e];A.current.display(o.cfi),A.current.annotations.highlight(o.cfi,{},(e=>{})),U(e)},variant:"outlined",children:"Previous"}),(0,k.jsx)(c.A,{style:{marginRight:"1%"},onClick:()=>{const e=(P+1)%z.length,o=z[e];A.current.display(o.cfi),A.current.annotations.highlight(o.cfi,{},(e=>{})),U(e)},variant:"outlined",children:"Next"})]}):(0,k.jsx)("p",{children:"No results found"})}),q&&(0,k.jsx)(h(),{children:(0,k.jsxs)("div",{style:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",zIndex:1e3,backgroundColor:"transparent",padding:"10px",borderRadius:"10px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.1)"},children:[(0,k.jsx)(y(),{url:q,controls:!0,playing:!0}),(0,k.jsx)("button",{onClick:()=>D(null),style:{marginTop:"10px",backgroundColor:"#f44336",color:"#fff",border:"none",borderRadius:"5px",padding:"5px 10px",cursor:"pointer"},children:"Cancel"})]})}),(0,k.jsx)(n.$W,{title:null===B||void 0===B?void 0:B.title,url:(null===B||void 0===B?void 0:B.ebookepubImagesUrl)||(null===B||void 0===B?void 0:B.ebook_url)||(null===B||void 0===B?void 0:B.ebookUrl),showToc:!0,location:E||ee,locationChanged:e=>oe(e),epubInitOptions:{openAs:"epub"},readerStyles:"dark"===p?C:w,getRendition:e=>{S(e,p,T),A.current=e,W.current=e,W.current.themes.default({"::selection":{background:"orange"}}),$([])},tocChanged:e=>Q.current=e}),(0,k.jsx)(g.A,{handleNewUserMessage:e=>{(0,x.toggleMsgLoader)(),fetch("https://yeeplatform.com/server/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ebook_id:B._id,query:e,user_id:J||"guest",title:B.title||"test",Description:B.Description||"test"})}).then((e=>e.json())).then((e=>{(0,x.addResponseMessage)(e.response)})).catch((e=>{console.error("Error:",e),(0,x.addResponseMessage)("Sorry, something went wrong.")})).finally((()=>{(0,x.toggleMsgLoader)()}))}})]})}}}]);
//# sourceMappingURL=5052.4eff337b.chunk.js.map